var $=Object.defineProperty;var V=(o,e,s)=>e in o?$(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var C=(o,e,s)=>V(o,typeof e!="symbol"?e+"":e,s);import{r as h,a as G,R as K}from"./vendor-cxkclgJA.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();var J={exports:{}},P={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y=h,X=Symbol.for("react.element"),Z=Symbol.for("react.fragment"),ee=Object.prototype.hasOwnProperty,te=Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,se={key:!0,ref:!0,__self:!0,__source:!0};function z(o,e,s){var n,i={},r=null,l=null;s!==void 0&&(r=""+s),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(l=e.ref);for(n in e)ee.call(e,n)&&!se.hasOwnProperty(n)&&(i[n]=e[n]);if(o&&o.defaultProps)for(n in e=o.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:X,type:o,key:r,ref:l,props:i,_owner:te.current}}P.Fragment=Z;P.jsx=z;P.jsxs=z;J.exports=P;var t=J.exports,D={},L=G;D.createRoot=L.createRoot,D.hydrateRoot=L.hydrateRoot;var S=(o=>(o.IDLE="idle",o.ACTIVE="active",o.PAUSED="paused",o.COMPLETED="completed",o))(S||{});const ne=[{id:"en-classic-beg-001",type:"mcq",prompt:'Choose the correct article: "I saw ___ elephant at the zoo."',choices:["a","an","the","no article"],answerIndex:1,explanation:'Use "an" before words starting with vowel sounds. "Elephant" starts with a vowel sound.'},{id:"en-classic-beg-002",type:"mcq",prompt:'Choose the correct article: "___ sun is bright today."',choices:["A","An","The","No article"],answerIndex:2,explanation:'Use "the" with unique objects like the sun, moon, earth.'},{id:"en-classic-beg-003",type:"typing",prompt:'Type the English word for "สวัสดี":',accept:["hello","hi","Hello","Hi"],explanation:'สวัสดี means "hello" or "hi" in English.'},{id:"en-classic-beg-004",type:"typing",prompt:'Type the English word for "ขอบคุณ":',accept:["thank you","thanks","Thank you","Thanks"],explanation:'ขอบคุณ means "thank you" or "thanks" in English.'},{id:"en-classic-beg-005",type:"mcq",prompt:'Choose the correct form: "She ___ to school every day."',choices:["go","goes","going","gone"],answerIndex:1,explanation:'Use "goes" with third person singular (he/she/it) in simple present tense.'},{id:"en-classic-beg-006",type:"mcq",prompt:'Choose the correct form: "They ___ English every morning."',choices:["study","studies","studying","studied"],answerIndex:0,explanation:'Use base form "study" with plural subjects (they/we/you) in simple present tense.'},{id:"en-classic-beg-007",type:"mcq",prompt:'Choose the correct question: "_____ your name?"',choices:["What","What is","What are","What do"],answerIndex:1,explanation:`Use "What is" to ask about someone's name.`},{id:"en-classic-beg-008",type:"open",prompt:"Introduce yourself in 2-3 sentences. Include your name and one thing you like.",explanation:"Practice basic self-introduction using simple present tense and personal information."},{id:"en-classic-beg-009",type:"open",prompt:"Describe your daily routine. What do you do in the morning?",explanation:"Practice using simple present tense to describe habitual actions."},{id:"en-classic-beg-010",type:"typing",prompt:'Write the number "15" in words:',accept:["fifteen","Fifteen"],explanation:'The number 15 is written as "fifteen".'}],ie=[{id:"en-classic-int-001",type:"mcq",prompt:'Choose the correct past tense: "Yesterday, I ___ to the market."',choices:["go","went","gone","going"],answerIndex:1,explanation:'The past tense of "go" is "went".'},{id:"en-classic-int-002",type:"mcq",prompt:'Choose the correct form: "She ___ her homework before dinner."',choices:["finish","finished","finishing","finishes"],answerIndex:1,explanation:'Use past tense "finished" for completed actions in the past.'},{id:"en-classic-int-003",type:"mcq",prompt:'Choose the correct form: "I ___ never ___ to Japan."',choices:["have / been","has / been","had / been","am / been"],answerIndex:0,explanation:'Use "have been" with first person (I) in present perfect tense.'},{id:"en-classic-int-004",type:"mcq",prompt:'Complete the sentence: "If it rains tomorrow, I ___ stay home."',choices:["will","would","can","should"],answerIndex:0,explanation:'Use "will" in the main clause of first conditional (if + present, will + base form).'},{id:"en-classic-int-005",type:"typing",prompt:'Type a synonym for "happy":',accept:["joyful","cheerful","glad","pleased","delighted","content"],explanation:'Common synonyms for "happy" include joyful, cheerful, glad, pleased, delighted, and content.'},{id:"en-classic-int-006",type:"mcq",prompt:'Choose the correct preposition: "The meeting is ___ 3 PM."',choices:["in","on","at","by"],answerIndex:2,explanation:'Use "at" with specific times (3 PM, noon, midnight).'},{id:"en-classic-int-007",type:"open",prompt:"Describe a memorable experience from your childhood. Use past tense.",explanation:"Practice using past tense forms and descriptive language to narrate personal experiences."},{id:"en-classic-int-008",type:"open",prompt:"What would you do if you won the lottery? Explain your plans.",explanation:"Practice using conditional structures (would + base form) to express hypothetical situations."}],re=[{id:"en-classic-adv-001",type:"mcq",prompt:'Choose the correct form: "By the time you arrive, I ___ the report."',choices:["will finish","will have finished","would finish","had finished"],answerIndex:1,explanation:'Use future perfect "will have finished" for actions completed before a future time.'},{id:"en-classic-adv-002",type:"mcq",prompt:'Choose the correct form: "I suggest that he ___ more carefully."',choices:["drives","drive","drove","driven"],answerIndex:1,explanation:'Use base form "drive" after "suggest that" (subjunctive mood).'},{id:"en-classic-adv-003",type:"typing",prompt:'Type a word meaning "to make something less severe":',accept:["mitigate","alleviate","diminish","reduce","lessen"],explanation:'Words like "mitigate" and "alleviate" mean to make something less severe or intense.'},{id:"en-classic-adv-004",type:"mcq",prompt:'What does "break the ice" mean?',choices:["To damage something","To start a conversation","To be very cold","To work hard"],answerIndex:1,explanation:'"Break the ice" is an idiom meaning to start a conversation or make people feel comfortable.'},{id:"en-classic-adv-005",type:"open",prompt:"Analyze the advantages and disadvantages of social media in modern society.",explanation:"Practice advanced argumentation, complex sentence structures, and analytical thinking."},{id:"en-classic-adv-006",type:"open",prompt:"Write a thesis statement for an essay about climate change solutions.",explanation:"Practice academic writing skills and creating clear, arguable thesis statements."}],oe=[{id:"en-classic-exp-001",type:"mcq",prompt:'Choose the most appropriate form: "The committee ___ on the proposal for hours."',choices:["has been deliberating","have been deliberating","is deliberating","are deliberating"],answerIndex:0,explanation:'Collective nouns like "committee" can take singular verbs when acting as a unit.'},{id:"en-classic-exp-002",type:"mcq",prompt:'In the phrase "the pen is mightier than the sword," what literary device is used?',choices:["Simile","Metaphor","Metonymy","Hyperbole"],answerIndex:2,explanation:"Metonymy substitutes the name of something with something closely associated (pen = writing, sword = violence)."},{id:"en-classic-exp-003",type:"typing",prompt:'Type a word meaning "existing in name only, not in reality":',accept:["nominal","titular","ostensible","purported"],explanation:'Words like "nominal" and "titular" describe something that exists in name only.'},{id:"en-classic-exp-004",type:"open",prompt:"Critically evaluate the role of artificial intelligence in shaping future educational paradigms.",explanation:"Practice expert-level critical thinking, complex argumentation, and sophisticated vocabulary."},{id:"en-classic-exp-005",type:"open",prompt:"Discuss the ethical implications of genetic engineering in human enhancement.",explanation:"Engage with complex ethical reasoning and advanced discourse structures."}],ae=[{id:"en-cefr-a1-001",type:"mcq",prompt:"How do you ask someone's name?",choices:["What your name?","What is your name?","What are your name?","How your name?"],answerIndex:1,explanation:'The correct question form is "What is your name?" using the verb "to be".'},{id:"en-cefr-a1-002",type:"typing",prompt:'Write your age using "I am ___ years old":',accept:["I am 20 years old","I am 25 years old","I am thirty years old","I am eighteen years old"],explanation:'Use "I am [number] years old" to state your age.'},{id:"en-cefr-a1-003",type:"mcq",prompt:"What do you call your father's brother?",choices:["cousin","uncle","nephew","grandfather"],answerIndex:1,explanation:"Your father's brother is your uncle."},{id:"en-cefr-a1-004",type:"mcq",prompt:'Complete: "I ___ breakfast at 7 AM."',choices:["eat","eats","eating","ate"],answerIndex:0,explanation:'Use "eat" (base form) with "I" in present simple tense.'},{id:"en-cefr-a1-005",type:"typing",prompt:'How do you say "ขวา" in English?',accept:["right","Right"],explanation:'ขวา means "right" in English (direction).'}],ce=[{id:"en-cefr-a2-001",type:"mcq",prompt:'Complete: "Yesterday, I ___ to the cinema."',choices:["go","went","going","gone"],answerIndex:1,explanation:'Use "went" (past simple) for completed actions in the past.'},{id:"en-cefr-a2-002",type:"mcq",prompt:'Complete: "This book is ___ than that one."',choices:["more interesting","most interesting","interesting","interestinger"],answerIndex:0,explanation:'Use "more + adjective" for comparatives with long adjectives.'},{id:"en-cefr-a2-003",type:"typing",prompt:'Complete: "I ___ visit my grandmother next week." (future plan)',accept:["am going to","will","plan to"],explanation:'Use "am going to", "will", or "plan to" to express future intentions.'},{id:"en-cefr-a2-004",type:"mcq",prompt:"How much does this cost?",choices:["It costs $10","It cost $10","It costing $10","It will cost $10"],answerIndex:0,explanation:'Use "It costs" (present simple) to state current prices.'},{id:"en-cefr-a2-005",type:"open",prompt:"Describe your best friend. What do they look like? What do they like to do?",explanation:"Practice describing physical appearance and personality using present simple tense."}],le=[{id:"en-cefr-b1-001",type:"mcq",prompt:'Complete: "I ___ to Paris three times."',choices:["went","have been","was","go"],answerIndex:1,explanation:'Use present perfect "have been" for life experiences without specific time.'},{id:"en-cefr-b1-002",type:"mcq",prompt:'Complete: "You ___ wear a helmet when riding a motorcycle."',choices:["can","should","might","would"],answerIndex:1,explanation:'Use "should" to give advice or express obligation.'},{id:"en-cefr-b1-003",type:"typing",prompt:'Complete the first conditional: "If it rains, I _____ stay home."',accept:["will","will stay","am going to"],explanation:'Use "will" in the main clause of first conditional sentences.'},{id:"en-cefr-b1-004",type:"open",prompt:"What is your opinion about online learning? Give reasons for your answer.",explanation:"Practice expressing and supporting opinions using appropriate linking words and examples."},{id:"en-cefr-b1-005",type:"mcq",prompt:'Change to passive: "They built this house in 1990."',choices:["This house built in 1990","This house was built in 1990","This house is built in 1990","This house has built in 1990"],answerIndex:1,explanation:'Use "was built" (past simple passive) for completed actions in the past.'}],de=[{id:"en-cefr-b2-001",type:"mcq",prompt:'Complete: "I wish I ___ more time to study."',choices:["have","had","would have","will have"],answerIndex:1,explanation:'Use past simple "had" after "I wish" to express regret about present situations.'},{id:"en-cefr-b2-002",type:"mcq",prompt:'Report: She said, "I am tired." → She said that she ___ tired.',choices:["is","was","has been","will be"],answerIndex:1,explanation:"Change present tense to past tense in reported speech when the reporting verb is past."},{id:"en-cefr-b2-003",type:"typing",prompt:'What word means "to make something better or improve it"?',accept:["enhance","improve","upgrade","refine","optimize"],explanation:'Words like "enhance", "improve", "upgrade", "refine", and "optimize" mean to make something better.'},{id:"en-cefr-b2-004",type:"open",prompt:"Discuss the impact of technology on traditional forms of communication. Consider both positive and negative aspects.",explanation:"Practice discussing complex topics with balanced arguments and sophisticated language."},{id:"en-cefr-b2-005",type:"mcq",prompt:'What does "put off" mean in: "We had to put off the meeting"?',choices:["cancel","postpone","attend","organize"],answerIndex:1,explanation:'"Put off" means to postpone or delay something to a later time.'}],ue=[{id:"en-cefr-c1-001",type:"mcq",prompt:'Complete: "___ the weather been better, we would have gone hiking."',choices:["If","Had","Should","Were"],answerIndex:1,explanation:'Use "Had" for inverted third conditional (Had + subject + past participle).'},{id:"en-cefr-c1-002",type:"typing",prompt:'What formal word means "to examine something carefully and in detail"?',accept:["analyze","analyse","scrutinize","examine","investigate"],explanation:'Academic words like "analyze", "scrutinize", and "investigate" mean to examine carefully.'},{id:"en-cefr-c1-003",type:"open",prompt:"Evaluate the effectiveness of international cooperation in addressing global challenges such as climate change.",explanation:"Practice advanced critical thinking, evaluation, and sophisticated argumentation structures."},{id:"en-cefr-c1-004",type:"mcq",prompt:'Choose the most appropriate word: "The evidence ___ supports the hypothesis."',choices:["strongly","hardly","barely","scarcely"],answerIndex:0,explanation:'"Strongly supports" indicates robust evidence, while the others suggest weak support.'},{id:"en-cefr-c1-005",type:"open",prompt:"Analyze the relationship between individual freedom and social responsibility in democratic societies.",explanation:"Engage with abstract philosophical concepts using sophisticated language and reasoning."}],pe=[{id:"en-cefr-c2-001",type:"mcq",prompt:'Choose the most natural expression: "The proposal was met with ___."',choices:["skeptical reception","skepticism","skeptical responses","skeptical reactions"],answerIndex:1,explanation:'"Met with skepticism" is the most natural and idiomatic expression.'},{id:"en-cefr-c2-002",type:"mcq",prompt:`Distinguish: "The politician's statement was ___" (suggesting deliberate deception)`,choices:["misleading","confusing","unclear","ambiguous"],answerIndex:0,explanation:'"Misleading" specifically implies intentional deception, while others suggest unintentional confusion.'},{id:"en-cefr-c2-003",type:"typing",prompt:'What literary term describes the use of "crown" to represent monarchy?',accept:["metonymy","synecdoche"],explanation:"Metonymy (or synecdoche) substitutes something closely associated with the thing being referenced."},{id:"en-cefr-c2-004",type:"open",prompt:"Critically examine the epistemological foundations of scientific knowledge and their implications for understanding reality.",explanation:"Demonstrate mastery of complex philosophical discourse and sophisticated analytical thinking."},{id:"en-cefr-c2-005",type:"open",prompt:"Discuss how cultural context influences the interpretation of literary works, using specific examples.",explanation:"Show deep understanding of cultural nuances and their impact on meaning and interpretation."}],he=[{id:"jp-classic-beg-001",type:"mcq",prompt:'What does "おはよう" mean?',choices:["Good evening","Good morning","Good afternoon","Good night"],answerIndex:1,explanation:'おはよう (ohayou) means "good morning" in casual Japanese.'},{id:"jp-classic-beg-002",type:"mcq",prompt:'What does "こんにちは" mean?',choices:["Good morning","Good afternoon/Hello","Good evening","Goodbye"],answerIndex:1,explanation:'こんにちは (konnichiwa) means "good afternoon" or general "hello".'},{id:"jp-classic-beg-003",type:"mcq",prompt:'Which hiragana represents the sound "ka"?',choices:["か","き","く","け"],answerIndex:0,explanation:'か (ka) is the hiragana character for the "ka" sound.'},{id:"jp-classic-beg-004",type:"mcq",prompt:'Which hiragana represents the sound "su"?',choices:["さ","し","す","せ"],answerIndex:2,explanation:'す (su) is the hiragana character for the "su" sound.'},{id:"jp-classic-beg-005",type:"typing",prompt:'Type "thank you" in Japanese (hiragana):',accept:["ありがとう","ありがとうございます"],explanation:'ありがとう (arigatou) or ありがとうございます (arigatou gozaimasu) means "thank you".'},{id:"jp-classic-beg-006",type:"typing",prompt:'Type "excuse me" in Japanese (hiragana):',accept:["すみません","すいません"],explanation:'すみません (sumimasen) means "excuse me" or "sorry".'},{id:"jp-classic-beg-007",type:"mcq",prompt:'How do you say "3" in Japanese?',choices:["に","さん","よん","ご"],answerIndex:1,explanation:'さん (san) means "three" in Japanese.'},{id:"jp-classic-beg-008",type:"mcq",prompt:'How do you say "5" in Japanese?',choices:["よん","ご","ろく","なな"],answerIndex:1,explanation:'ご (go) means "five" in Japanese.'},{id:"jp-classic-beg-009",type:"mcq",prompt:"Which particle marks the topic of a sentence?",choices:["を","に","は","が"],answerIndex:2,explanation:"は (wa) is the topic particle in Japanese, though written with は."},{id:"jp-classic-beg-010",type:"open",prompt:"Introduce yourself in Japanese. Include your name and nationality.",explanation:"Practice basic self-introduction using わたしは (watashi wa) and です (desu)."}],me=[{id:"jp-classic-int-001",type:"mcq",prompt:'Which katakana represents the sound "ko"?',choices:["カ","キ","ク","コ"],answerIndex:3,explanation:'コ (ko) is the katakana character for the "ko" sound.'},{id:"jp-classic-int-002",type:"mcq",prompt:'What is the past tense of "たべます" (to eat)?',choices:["たべました","たべる","たべて","たべない"],answerIndex:0,explanation:'たべました (tabemashita) is the polite past tense of "to eat".'},{id:"jp-classic-int-003",type:"mcq",prompt:'What is the negative form of "いきます" (to go)?',choices:["いきました","いかない","いきません","いって"],answerIndex:2,explanation:'いきません (ikimasen) is the polite negative form of "to go".'},{id:"jp-classic-int-004",type:"mcq",prompt:'How do you say "This book is interesting"?',choices:["この本はおもしろいです","この本はおもしろかったです","この本はおもしろくないです","この本はおもしろくありません"],answerIndex:0,explanation:'この本はおもしろいです (kono hon wa omoshiroi desu) means "This book is interesting".'},{id:"jp-classic-int-005",type:"typing",prompt:'How do you say "yesterday" in Japanese?',accept:["きのう","昨日"],explanation:'きのう (kinou) means "yesterday" in Japanese.'},{id:"jp-classic-int-006",type:"typing",prompt:'How do you say "tomorrow" in Japanese?',accept:["あした","あす","明日"],explanation:'あした (ashita) or あす (asu) means "tomorrow" in Japanese.'},{id:"jp-classic-int-007",type:"mcq",prompt:'How do you count "3 people"?',choices:["さんにん","さんこ","さんまい","さんぼん"],answerIndex:0,explanation:"さんにん (san-nin) is used to count three people. にん is the counter for people."},{id:"jp-classic-int-008",type:"open",prompt:"Describe your daily routine in Japanese. What time do you wake up? What do you eat for breakfast?",explanation:"Practice using time expressions, daily activity verbs, and polite forms in Japanese."}],ge=[{id:"jp-classic-adv-001",type:"mcq",prompt:'What is the honorific form of "いる" (to be/exist)?',choices:["います","いらっしゃいます","おります","ございます"],answerIndex:1,explanation:"いらっしゃいます (irasshaimasu) is the honorific form of いる, used for others."},{id:"jp-classic-adv-002",type:"mcq",prompt:'What is the humble form of "いう" (to say)?',choices:["おっしゃいます","もうします","いいます","はなします"],answerIndex:1,explanation:"もうします (moushimasu) is the humble form of いう, used when speaking about oneself."},{id:"jp-classic-adv-003",type:"mcq",prompt:`Complete: "雨が降っている___、出かけません。" (Because it's raining, I won't go out)`,choices:["ので","から","ために","のに"],answerIndex:0,explanation:"ので (node) is used to express reason/cause in a more objective way."},{id:"jp-classic-adv-004",type:"mcq",prompt:'Which conditional form expresses "If you study, you will pass"?',choices:["勉強すれば、合格します","勉強したら、合格します","勉強すると、合格します","All of the above"],answerIndex:3,explanation:'All three forms (ば, たら, と) can express conditional "if" in different contexts.'},{id:"jp-classic-adv-005",type:"typing",prompt:'What is the Japanese word for "environment"?',accept:["かんきょう","環境"],explanation:'かんきょう (kankyou) means "environment" in Japanese.'},{id:"jp-classic-adv-006",type:"open",prompt:'Explain the concept of "おもてなし" (omotenashi) and its importance in Japanese culture.',explanation:"Practice discussing cultural concepts using advanced Japanese vocabulary and expressions."},{id:"jp-classic-adv-007",type:"mcq",prompt:'How do you politely say "I received your email" in business Japanese?',choices:["メールをもらいました","メールをいただきました","メールを受けました","メールがきました"],answerIndex:1,explanation:"いただきました is the humble form, appropriate for business communication."}],fe=[{id:"jp-classic-exp-001",type:"mcq",prompt:'In classical Japanese, what does "けり" indicate?',choices:["Past tense","Realization/Discovery","Probability","Respect"],answerIndex:1,explanation:"けり (keri) in classical Japanese indicates realization or discovery of a past state."},{id:"jp-classic-exp-002",type:"typing",prompt:"What is the reading of 憂鬱 (depression/melancholy)?",accept:["ゆううつ","yuuutsu"],explanation:"憂鬱 is read as ゆううつ (yuuutsu) meaning depression or melancholy."},{id:"jp-classic-exp-003",type:"open",prompt:"Analyze the use of seasonal imagery (季語) in traditional Japanese poetry and its cultural significance.",explanation:"Demonstrate deep understanding of Japanese literary traditions and cultural symbolism."},{id:"jp-classic-exp-004",type:"mcq",prompt:'In Kansai dialect, how do you say "だめ" (no good/useless)?',choices:["あかん","いかん","だちかん","なんば"],answerIndex:0,explanation:"あかん (akan) is the Kansai dialect equivalent of だめ (dame)."},{id:"jp-classic-exp-005",type:"open",prompt:'Discuss the concept of "間" (ma) in Japanese aesthetics and its manifestation in various art forms.',explanation:"Explore complex philosophical and aesthetic concepts unique to Japanese culture."}],ye=[{id:"jp-jlpt-n5-001",type:"mcq",prompt:"Choose the correct reading: 学生",choices:["がくせい","がくしょう","がっこう","せんせい"],answerIndex:0,explanation:'学生 is read as がくせい (gakusei) meaning "student".'},{id:"jp-jlpt-n5-002",type:"mcq",prompt:"Choose the correct reading: 先生",choices:["がくせい","せんせい","せんぱい","こうはい"],answerIndex:1,explanation:'先生 is read as せんせい (sensei) meaning "teacher".'},{id:"jp-jlpt-n5-003",type:"mcq",prompt:"Fill in the particle: 私___学生です。",choices:["は","が","を","に"],answerIndex:0,explanation:'は (wa) is the topic particle. 私は学生です means "I am a student".'},{id:"jp-jlpt-n5-004",type:"mcq",prompt:"Fill in the particle: 本___読みます。",choices:["は","が","を","に"],answerIndex:2,explanation:'を (wo) marks the direct object. 本を読みます means "I read a book".'},{id:"jp-jlpt-n5-005",type:"mcq",prompt:"What is the polite form of 食べる?",choices:["食べます","食べました","食べません","食べて"],answerIndex:0,explanation:'食べます (tabemasu) is the polite present form of 食べる (taberu) "to eat".'},{id:"jp-jlpt-n5-006",type:"typing",prompt:`How do you say "7 o'clock" in Japanese?`,accept:["しちじ","ななじ","7時"],explanation:`しちじ (shichiji) or ななじ (nanaji) means "7 o'clock".`},{id:"jp-jlpt-n5-007",type:"mcq",prompt:'How do you say "mother" (your own)?',choices:["おかあさん","はは","おばあさん","おねえさん"],answerIndex:1,explanation:"はは (haha) is used when referring to your own mother to others."},{id:"jp-jlpt-n5-008",type:"mcq",prompt:"Complete: この本は___です。(This book is interesting)",choices:["おもしろい","おもしろく","おもしろかった","おもしろくない"],answerIndex:0,explanation:'おもしろい (omoshiroi) is the basic form of i-adjective meaning "interesting".'},{id:"jp-jlpt-n5-009",type:"mcq",prompt:"Complete: 机の上___本があります。(There is a book on the desk)",choices:["は","が","を","に"],answerIndex:3,explanation:"に (ni) indicates location where something exists."},{id:"jp-jlpt-n5-010",type:"open",prompt:"Write a short self-introduction in Japanese including your name, nationality, and occupation.",explanation:"Practice N5 level self-introduction using basic grammar patterns and vocabulary."}],xe=[{id:"jp-jlpt-n4-001",type:"mcq",prompt:"What is the te-form of 読む?",choices:["読んで","読みて","読いて","読って"],answerIndex:0,explanation:'読んで (yonde) is the te-form of 読む (yomu) "to read".'},{id:"jp-jlpt-n4-002",type:"mcq",prompt:"Complete: 今、宿題___います。(I am doing homework now)",choices:["をして","をしている","をした","をします"],answerIndex:1,explanation:'をしています indicates ongoing action "I am doing homework".'},{id:"jp-jlpt-n4-003",type:"mcq",prompt:'How do you say "I can speak Japanese"?',choices:["日本語を話します","日本語が話せます","日本語を話しました","日本語を話してください"],answerIndex:1,explanation:'話せます (hanasemasu) is the potential form meaning "can speak".'},{id:"jp-jlpt-n4-004",type:"mcq",prompt:"Complete: AはBより___です。(A is more expensive than B)",choices:["安い","高い","大きい","小さい"],answerIndex:1,explanation:'高い (takai) means "expensive". より indicates comparison "more than".'},{id:"jp-jlpt-n4-005",type:"mcq",prompt:"Complete: 友達___プレゼントをもらいました。",choices:["に","から","で","と"],answerIndex:1,explanation:'から (kara) indicates the source "I received a present from my friend".'},{id:"jp-jlpt-n4-006",type:"typing",prompt:'How do you say "I have been to Tokyo" (experience)?',accept:["東京に行ったことがあります","東京へ行ったことがあります"],explanation:'ことがあります expresses past experience "I have been to Tokyo".'},{id:"jp-jlpt-n4-007",type:"mcq",prompt:'How do you express intention "I plan to go to Japan"?',choices:["日本に行きます","日本に行くつもりです","日本に行きました","日本に行ってください"],answerIndex:1,explanation:'つもりです expresses intention or plan "I plan to go".'},{id:"jp-jlpt-n4-008",type:"open",prompt:"Describe how your Japanese ability has changed since you started studying. Use appropriate grammar for expressing change.",explanation:"Practice N4 grammar for expressing change and improvement using forms like ようになりました."}],ve=[{id:"jp-jlpt-n3-001",type:"mcq",prompt:"What is the causative form of 食べる?",choices:["食べさせる","食べられる","食べさせられる","食べさす"],answerIndex:0,explanation:'食べさせる (tabesaseru) is the causative form meaning "to make/let someone eat".'},{id:"jp-jlpt-n3-002",type:"mcq",prompt:"Complete the passive sentence: この本は多くの人___読まれています。",choices:["が","を","に","によって"],answerIndex:3,explanation:'によって indicates the agent in passive sentences "This book is read by many people".'},{id:"jp-jlpt-n3-003",type:"mcq",prompt:'Which expresses "If I were rich, I would travel"?',choices:["お金持ちだったら、旅行します","お金持ちなら、旅行します","お金持ちだったら、旅行するでしょう","All are possible"],answerIndex:3,explanation:"All forms can express hypothetical conditions with slight nuance differences."},{id:"jp-jlpt-n3-004",type:"mcq",prompt:"Complete: 雨が降りそう___、傘を持って行きます。",choices:["だから","なので","ので","All are correct"],answerIndex:3,explanation:`All three expressions can indicate reason "Because it looks like rain, I'll take an umbrella".`},{id:"jp-jlpt-n3-005",type:"typing",prompt:'How do you say "It seems like he is busy"?',accept:["忙しそうです","忙しいようです","忙しいみたいです"],explanation:"そうです, ようです, and みたいです all express appearance or hearsay."},{id:"jp-jlpt-n3-006",type:"mcq",prompt:"Complete: 宿題をする___、友達と遊びに行きました。",choices:["前に","後で","かわりに","ために"],answerIndex:2,explanation:'かわりに means "instead of" - "Instead of doing homework, I went to play with friends".'},{id:"jp-jlpt-n3-007",type:"open",prompt:"Write about something you regret not doing in the past. Use appropriate N3 grammar patterns.",explanation:"Practice expressing regret using patterns like ～ばよかった or ～べきでした."}],be=[{id:"jp-jlpt-n2-001",type:"mcq",prompt:"Complete: 彼は忙しい___、手伝ってくれました。",choices:["にもかかわらず","にしても","にしては","について"],answerIndex:0,explanation:'にもかかわらず means "despite/in spite of" - "Despite being busy, he helped me".'},{id:"jp-jlpt-n2-002",type:"mcq",prompt:'Which is the most formal way to say "regarding this matter"?',choices:["この件について","この件に関して","この件につきまして","この件のことで"],answerIndex:2,explanation:'につきまして is the most formal expression for "regarding/concerning".'},{id:"jp-jlpt-n2-003",type:"typing",prompt:'What word means "to take into consideration"?',accept:["考慮する","こうりょする"],explanation:'考慮する (kouryo suru) means "to take into consideration".'},{id:"jp-jlpt-n2-004",type:"mcq",prompt:"Complete: もう少し早く出発していれば、間に合った___。",choices:["でしょう","はずです","のに","かもしれません"],answerIndex:2,explanation:'のに expresses regret "If I had left earlier, I would have made it".'},{id:"jp-jlpt-n2-005",type:"open",prompt:"Write a formal email declining a meeting invitation. Use appropriate keigo and business expressions.",explanation:"Practice N2 level formal writing with proper keigo and business etiquette."},{id:"jp-jlpt-n2-006",type:"mcq",prompt:'What does the expression "空気を読む" mean?',choices:["To read books","To understand the atmosphere/situation","To breathe fresh air","To study hard"],answerIndex:1,explanation:'空気を読む (kuuki wo yomu) means "to read the atmosphere" or understand unspoken social cues.'}],we=[{id:"jp-jlpt-n1-001",type:"mcq",prompt:"Complete the formal expression: ご質問___、お答えいたします。",choices:["については","に関しましては","につきましては","All are correct"],answerIndex:3,explanation:'All three are highly formal ways to say "regarding your question".'},{id:"jp-jlpt-n1-002",type:"mcq",prompt:"What does ～んばかりに express?",choices:["Almost to the point of","Only if","As soon as","In order to"],answerIndex:0,explanation:'～んばかりに expresses "almost to the point of" or "as if about to".'},{id:"jp-jlpt-n1-003",type:"typing",prompt:'What is the formal word for "to implement/execute"?',accept:["実施する","じっしする","遂行する","すいこうする"],explanation:'実施する (jisshi suru) or 遂行する (suikou suru) mean "to implement/execute".'},{id:"jp-jlpt-n1-004",type:"mcq",prompt:"Choose the most appropriate: 彼の提案は___ものがある。",choices:["興味深い","興味深いところの","興味をそそる","興味深いものの"],answerIndex:1,explanation:'興味深いところのある means "has interesting aspects" - more nuanced than simple "interesting".'},{id:"jp-jlpt-n1-005",type:"open",prompt:"Write an analysis of the impact of demographic changes on Japanese society. Use N1 level vocabulary and grammar.",explanation:"Demonstrate mastery of academic Japanese with complex analysis and sophisticated language."},{id:"jp-jlpt-n1-006",type:"open",prompt:"Discuss the evolution of Japanese language policy in the post-war period and its social implications.",explanation:"Show deep understanding of Japanese society, history, and language policy using advanced Japanese."}],I=[{id:"en-001",type:"mcq",prompt:'What is the past tense of "go"?',choices:["went","gone","going","goes"],answerIndex:0,explanation:'The past tense of "go" is "went".'},{id:"en-002",type:"mcq",prompt:'Choose the correct article: "I saw ___ elephant."',choices:["a","an","the","no article"],answerIndex:1,explanation:'Use "an" before words starting with vowel sounds.'},{id:"en-003",type:"typing",prompt:'Type the word for "สวัสดี" in English:',accept:["hello","hi"],explanation:'สวัสดี means "hello" or "hi" in English.'},{id:"en-004",type:"mcq",prompt:"Which is correct?",choices:["I am happy","I is happy","I are happy","I be happy"],answerIndex:0,explanation:'Use "am" with "I".'},{id:"en-005",type:"typing",prompt:'Type the plural of "child":',accept:["children"],explanation:'The plural of "child" is "children".'},{id:"en-006",type:"mcq",prompt:'What does "beautiful" mean?',choices:["ugly","pretty","big","small"],answerIndex:1,explanation:"Beautiful means pretty or attractive."},{id:"en-007",type:"typing",prompt:'Type the opposite of "hot":',accept:["cold"],explanation:"The opposite of hot is cold."},{id:"en-008",type:"mcq",prompt:'Choose the correct form: "She ___ to school."',choices:["go","goes","going","gone"],answerIndex:1,explanation:'Use "goes" with third person singular (she/he/it).'},{id:"en-009",type:"typing",prompt:'Type the past tense of "eat":',accept:["ate"],explanation:'The past tense of "eat" is "ate".'},{id:"en-010",type:"mcq",prompt:"What is the correct question word for asking about time?",choices:["What","Where","When","Who"],answerIndex:2,explanation:'Use "When" to ask about time.'},{id:"en-011",type:"typing",prompt:'Type the word for "ขอบคุณ" in English:',accept:["thank you","thanks"],explanation:'ขอบคุณ means "thank you" in English.'},{id:"en-012",type:"mcq",prompt:"Which sentence is correct?",choices:["I have a book","I has a book","I having a book","I had have a book"],answerIndex:0,explanation:'Use "have" with "I".'},{id:"en-013",type:"typing",prompt:'Type the present continuous form of "run" (I ___ running):',accept:["am"],explanation:'Use "am" with "I" in present continuous.'},{id:"en-014",type:"mcq",prompt:'What is the correct preposition: "I live ___ Bangkok."',choices:["at","in","on","by"],answerIndex:1,explanation:'Use "in" with cities and countries.'},{id:"en-015",type:"typing",prompt:'Type the comparative form of "good":',accept:["better"],explanation:'The comparative form of "good" is "better".'},{id:"en-016",type:"open",prompt:"Describe your favorite food in 2-3 sentences.",explanation:"Practice describing things you like using adjectives and reasons."},{id:"en-017",type:"open",prompt:"Write about what you did yesterday.",explanation:"Practice using past tense to describe past events."}],Q=[{id:"jp-001",type:"mcq",prompt:'What does "こんにちは" mean?',choices:["Good morning","Good afternoon","Good evening","Good night"],answerIndex:1,explanation:'こんにちは (konnichiwa) means "good afternoon" or general greeting.'},{id:"jp-002",type:"typing",prompt:'Type "thank you" in Japanese (hiragana):',accept:["ありがとう","arigatou"],explanation:'ありがとう (arigatou) means "thank you" in Japanese.'},{id:"jp-003",type:"mcq",prompt:'Which hiragana represents the sound "ka"?',choices:["か","き","く","け"],answerIndex:0,explanation:'か (ka) is the hiragana character for the "ka" sound.'}],je={EN:{Classic:{Beginner:I,Intermediate:I,Advanced:I,Expert:I},CEFR:{A1:I,A2:I,B1:I,B2:I,C1:I,C2:I}},JP:{Classic:{Beginner:Q,Intermediate:Q,Advanced:Q,Expert:Q},JLPT:{N5:Q,N4:Q,N3:Q,N2:Q,N1:Q}}},A={EN:{Classic:{Beginner:ne,Intermediate:ie,Advanced:re,Expert:oe},CEFR:{A1:ae,A2:ce,B1:le,B2:de,C1:ue,C2:pe}},JP:{Classic:{Beginner:he,Intermediate:me,Advanced:ge,Expert:fe},JLPT:{N5:ye,N4:xe,N3:ve,N2:be,N1:we}}},Se=()=>Object.keys(A),ke=o=>{const e=A[o];return e?Object.keys(e):[]},Ne=(o,e)=>{const s=A[o];if(!s)return[];const n=s[e];return n?Object.keys(n):[]},Ie=(o,e,s)=>{const n=A[o];if(!n)return 0;const i=n[e];if(!i)return 0;const r=i[s];return r?r.length:0},M=(o,e,s)=>{const n=A[o];if(!n)return[];const i=n[e];return i?i[s]||[]:[]},Ce=(o,e,s,n)=>M(o,e,s).filter(r=>r.type===n),Qe=(o,e,s,n)=>[...M(o,e,s)].sort(()=>Math.random()-.5).slice(0,n);class Te{constructor(e){C(this,"questionBank");C(this,"currentSession",null);C(this,"sessionHistory",[]);C(this,"customQuestions",[]);this.questionBank=e,this.loadCustomQuestions()}startSession(e){this.currentSession&&this.currentSession.state===S.ACTIVE&&this.pauseSession();const s=this.getQuestionsForSession(e);if(s.length===0)return!1;const n=this.shuffleArray([...s]);let i=n;if(e.questionCount)i=n.slice(0,e.questionCount);else switch(e.mode){case"Quiz":const r=Math.min(Math.max(e.questionCount||10,6),14);i=n.slice(0,r);break;case"Exam":i=n.slice(0,20);break;case"Study":break;default:i=n.slice(0,15)}return this.currentSession={config:e,questions:i,currentIndex:0,answers:new Array(i.length).fill(null),correct:new Array(i.length).fill(!1),startTime:new Date,totalPausedDuration:0,state:S.ACTIVE,sessionId:this.generateSessionId()},!0}getSessionState(){return this.currentSession?.state||S.IDLE}pauseSession(){return!this.currentSession||this.currentSession.state!==S.ACTIVE?!1:(this.currentSession.state=S.PAUSED,this.currentSession.pausedTime=new Date,!0)}resumeSession(){if(!this.currentSession||this.currentSession.state!==S.PAUSED)return!1;if(this.currentSession.pausedTime){const e=Date.now()-this.currentSession.pausedTime.getTime();this.currentSession.totalPausedDuration=(this.currentSession.totalPausedDuration||0)+e,this.currentSession.pausedTime=void 0}return this.currentSession.state=S.ACTIVE,!0}isSessionActive(){return this.currentSession?.state===S.ACTIVE}getSessionDuration(){if(!this.currentSession||!this.currentSession.startTime)return 0;const e=Date.now(),s=this.currentSession.startTime.getTime(),n=e-s;let i=this.currentSession.totalPausedDuration||0;return this.currentSession.state===S.PAUSED&&this.currentSession.pausedTime&&(i+=e-this.currentSession.pausedTime.getTime()),Math.max(0,n-i)}getCurrentQuestion(){if(!this.currentSession)return null;const{questions:e,currentIndex:s}=this.currentSession;return s<0||s>=e.length?null:e[s]||null}getSessionProgress(){if(!this.currentSession)return{current:0,total:0,correct:0,score:0};const{currentIndex:e,questions:s,correct:n}=this.currentSession;if(!s||!n)return{current:0,total:0,correct:0,score:0};const i=n.slice(0,e).filter(Boolean).length,r=e>0?Math.round(i/e*100):0;return{current:e,total:s.length,correct:i,score:r}}answerMCQ(e){if(!this.isSessionActive())return{isCorrect:!1,isValid:!1,error:"Session is not active",feedback:"Please start a session first"};if(this.isQuizMode()&&this.getQuizProgress().isComplete)return{isCorrect:!1,isValid:!1,error:"Quiz is already complete",feedback:"This quiz session has ended. Please start a new quiz."};const s=this.getCurrentQuestion();if(!s||s.type!=="mcq")return{isCorrect:!1,isValid:!1,error:"Invalid question type",feedback:"This is not a multiple choice question"};const n=s;if(e<0||e>=n.choices.length)return{isCorrect:!1,isValid:!1,error:"Invalid choice index",feedback:"Please select a valid option"};const i=e===n.answerIndex,r=n.choices[e],l=n.choices[n.answerIndex];return this.recordAnswer(e,i),{isCorrect:i,isValid:!0,selectedAnswer:r,correctAnswer:l,explanation:n.explanation,feedback:i?"Correct! Well done.":`Incorrect. The correct answer is "${l}".`,score:this.calculateQuestionScore(i,s)}}answerTyping(e){if(!this.isSessionActive())return{isCorrect:!1,isValid:!1,error:"Session is not active",feedback:"Please start a session first"};if(this.isQuizMode()&&this.getQuizProgress().isComplete)return{isCorrect:!1,isValid:!1,error:"Quiz is already complete",feedback:"This quiz session has ended. Please start a new quiz."};const s=this.getCurrentQuestion();if(!s||s.type!=="typing")return{isCorrect:!1,isValid:!1,error:"Invalid question type",feedback:"This is not a typing question"};if(!e||e.trim().length===0)return{isCorrect:!1,isValid:!1,error:"Empty input",feedback:"Please enter an answer"};const n=s,i=this.normalizeText(e.trim());let r=n.accept.some(c=>this.normalizeText(c)===i),l="exact";r||(r=this.checkFuzzyMatch(i,n.accept),l="partial");const a=n.accept;return this.recordAnswer(e.trim(),r),{isCorrect:r,isValid:!0,selectedAnswer:e.trim(),correctAnswer:a[0],acceptedAnswers:a,explanation:n.explanation,feedback:r?l==="exact"?"Perfect! Exactly right.":"Good! Close enough.":`Incorrect. Accepted answers: ${a.join(", ")}`,score:this.calculateQuestionScore(r,s,l==="partial"?.8:1)}}answerOpen(e){if(!this.isSessionActive())return{isCorrect:!0,isValid:!1,error:"Session is not active",feedback:"Please start a session first"};const s=this.getCurrentQuestion();return!s||s.type!=="open"?{isCorrect:!0,isValid:!1,error:"Invalid question type",feedback:"This is not an open-ended question"}:!e||e.trim().length===0?{isCorrect:!0,isValid:!1,error:"Empty input",feedback:"Please provide an answer"}:e.trim().length<10?{isCorrect:!0,isValid:!0,selectedAnswer:e.trim(),explanation:s.explanation,feedback:"Thank you for your answer. Consider providing more detail.",score:this.calculateQuestionScore(!0,s,.7),suggestions:["Try to elaborate more on your answer","Add specific examples","Explain your reasoning"]}:(this.recordAnswer(e.trim(),!0),{isCorrect:!0,isValid:!0,selectedAnswer:e.trim(),explanation:s.explanation,feedback:"Great! Thank you for your detailed response.",score:this.calculateQuestionScore(!0,s),wordCount:e.trim().split(/\s+/).length})}recordAnswer(e,s){if(!this.currentSession)return;const{currentIndex:n,answers:i,correct:r}=this.currentSession;!i||!r||n<0||n>=i.length||(i[n]=e,r[n]=s)}nextQuestion(){if(!this.isSessionActive())return{success:!1,error:"Session is not active",currentIndex:-1,totalQuestions:0};if(!this.currentSession)return{success:!1,error:"No active session",currentIndex:-1,totalQuestions:0};const{currentIndex:e,questions:s}=this.currentSession;return e>=s.length-1?{success:!1,error:"Already at last question",currentIndex:e,totalQuestions:s.length,isLastQuestion:!0}:(this.currentSession.currentIndex++,{success:!0,currentIndex:this.currentSession.currentIndex,totalQuestions:s.length,isFirstQuestion:this.currentSession.currentIndex===0,isLastQuestion:this.currentSession.currentIndex===s.length-1,question:this.getCurrentQuestion()})}previousQuestion(){if(!this.isSessionActive())return{success:!1,error:"Session is not active",currentIndex:-1,totalQuestions:0};if(!this.currentSession)return{success:!1,error:"No active session",currentIndex:-1,totalQuestions:0};const{currentIndex:e,questions:s}=this.currentSession;return e<=0?{success:!1,error:"Already at first question",currentIndex:e,totalQuestions:s.length,isFirstQuestion:!0}:(this.currentSession.currentIndex--,{success:!0,currentIndex:this.currentSession.currentIndex,totalQuestions:s.length,isFirstQuestion:this.currentSession.currentIndex===0,isLastQuestion:this.currentSession.currentIndex===s.length-1,question:this.getCurrentQuestion()})}skipQuestion(){if(!this.isSessionActive())return{success:!1,error:"Session is not active",currentIndex:-1,totalQuestions:0};if(!this.currentSession)return{success:!1,error:"No active session",currentIndex:-1,totalQuestions:0};const{currentIndex:e,answers:s,correct:n,questions:i}=this.currentSession;return s[e]=null,n[e]=!1,{success:!0,currentIndex:this.currentSession.currentIndex,totalQuestions:i.length,isFirstQuestion:this.currentSession.currentIndex===0,isLastQuestion:this.currentSession.currentIndex===i.length-1,question:this.getCurrentQuestion(),wasSkipped:!0}}jumpToQuestion(e){if(!this.isSessionActive())return{success:!1,error:"Session is not active",currentIndex:-1,totalQuestions:0};if(!this.currentSession)return{success:!1,error:"No active session",currentIndex:-1,totalQuestions:0};const{questions:s}=this.currentSession;if(e<0||e>=s.length)return{success:!1,error:`Invalid question index: ${e}. Must be between 0 and ${s.length-1}`,currentIndex:this.currentSession.currentIndex,totalQuestions:s.length};const n=this.currentSession.currentIndex;return this.currentSession.currentIndex=e,{success:!0,currentIndex:e,totalQuestions:s.length,isFirstQuestion:e===0,isLastQuestion:e===s.length-1,question:this.getCurrentQuestion(),previousIndex:n}}hasNextQuestion(){return this.currentSession?this.currentSession.currentIndex<this.currentSession.questions.length-1:!1}hasPreviousQuestion(){return this.currentSession?this.currentSession.currentIndex>0:!1}finishSession(){if(!this.currentSession)return{success:!1,error:"No active session to finish"};if(this.currentSession.state===S.COMPLETED)return{success:!1,error:"Session is already completed"};this.currentSession.state=S.COMPLETED;const{config:e,correct:s,questions:n,answers:i}=this.currentSession,r=i.filter(y=>y!==null).length,l=s.filter(Boolean).length,a=i.filter(y=>y===null).length,c=n.length,d=c>0?l/c*100:0,g=c>0?r/c*100:0,f=this.getSessionDuration(),v={date:new Date().toISOString(),track:e.track,framework:e.framework,level:e.level,mode:e.mode,scorePct:d,total:c,correct:l},u={sessionId:this.currentSession.sessionId,config:e,totalQuestions:c,answeredQuestions:r,correctAnswers:l,incorrectAnswers:r-l,skippedQuestions:a,scorePct:d,completionRate:g,sessionDuration:f,startTime:this.currentSession.startTime,endTime:new Date,questions:n.map((y,b)=>({question:y,answer:i[b],isCorrect:s[b],wasSkipped:i[b]===null}))};return this.sessionHistory.push({...this.currentSession}),{success:!0,progressEntry:v,sessionSummary:u,achievements:this.calculateAchievements(u)}}calculateAchievements(e){const s=[];return e.scorePct===100&&e.completionRate===100&&s.push({id:"perfect_score",title:"Perfect Score!",description:"Answered all questions correctly",icon:"🏆",rarity:"legendary"}),e.scorePct>=90&&e.completionRate>=90&&s.push({id:"high_score",title:"Excellent Performance",description:"Scored 90% or higher",icon:"⭐",rarity:"rare"}),e.sessionDuration/e.totalQuestions<3e4&&e.scorePct>=80&&s.push({id:"speed_demon",title:"Speed Demon",description:"Fast and accurate answers",icon:"⚡",rarity:"epic"}),e.completionRate===100&&s.push({id:"completionist",title:"Completionist",description:"Answered all questions",icon:"✅",rarity:"common"}),e.skippedQuestions===0&&e.totalQuestions>5&&s.push({id:"no_skips",title:"No Skips",description:"Attempted every question",icon:"🎯",rarity:"uncommon"}),s}resetSession(e=!0){if(!this.currentSession)return{success:!1,error:"No active session to reset",sessionId:"",wasCompleted:!1,questionsAnswered:0,savedToHistory:!1};const s=this.currentSession.sessionId,n=this.currentSession.state===S.COMPLETED,i=this.currentSession.answers.filter(r=>r!==null).length;return e&&i>0&&(this.currentSession.state!==S.COMPLETED&&(this.currentSession.state=S.IDLE),this.sessionHistory.push({...this.currentSession})),this.clearStoredSession(),this.currentSession=null,{success:!0,sessionId:s,wasCompleted:n,questionsAnswered:i,savedToHistory:e&&i>0}}restartSession(){if(!this.currentSession)return{success:!1,error:"No active session to restart",sessionId:"",wasCompleted:!1,questionsAnswered:0,savedToHistory:!1};const e={...this.currentSession.config},s=this.currentSession.sessionId;return this.resetSession(!1),this.startSession(e)?{success:!0,sessionId:s,wasCompleted:!1,questionsAnswered:0,savedToHistory:!1,restarted:!0,newSessionId:this.currentSession?.sessionId}:{success:!1,error:"Failed to restart session with same configuration",sessionId:s,wasCompleted:!1,questionsAnswered:0,savedToHistory:!1}}forceReset(){const e=this.currentSession!==null,s=this.sessionHistory.length;return this.currentSession=null,this.sessionHistory=[],this.clearStoredSession(),{success:!0,sessionId:"force_reset",wasCompleted:!1,questionsAnswered:0,savedToHistory:!1,clearedHistory:s,hadActiveSession:e}}getSessionHistory(){return[...this.sessionHistory]}clearSessionHistory(){this.sessionHistory=[]}getSessionById(e){return this.sessionHistory.find(s=>s.sessionId===e)||null}shuffleArray(e){const s=[...e];for(let n=s.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1)),r=s[n];s[n]=s[i],s[i]=r}return s}normalizeText(e){return e.toLowerCase().trim().replace(/[^\w\s]/g,"").replace(/\s+/g," ").replace(/\u00a0/g," ")}checkFuzzyMatch(e,s){return s.some(i=>{const r=this.normalizeText(i);return this.calculateStringSimilarity(e,r)>=.8})}calculateStringSimilarity(e,s){const n=e.length,i=s.length;if(n===0)return i===0?1:0;if(i===0)return 0;const r=Array(n+1).fill(null).map(()=>Array(i+1).fill(null));for(let a=0;a<=n;a++)r[a][0]=a;for(let a=0;a<=i;a++)r[0][a]=a;for(let a=1;a<=n;a++)for(let c=1;c<=i;c++){const d=e[a-1]===s[c-1]?0:1;r[a][c]=Math.min(r[a-1][c]+1,r[a][c-1]+1,r[a-1][c-1]+d)}const l=Math.max(n,i);return(l-r[n][i])/l}calculateQuestionScore(e,s,n=1){if(!e)return 0;const r={mcq:10,typing:15,open:20}[s.type]||10;return Math.round(r*n)}validateAnswer(e,s){switch(e){case"mcq":return this.validateMCQAnswer(s);case"typing":return this.validateTypingAnswer(s);case"open":return this.validateOpenAnswer(s);default:return{isValid:!1,errors:["Unknown question type"],suggestions:["Please check the question type"]}}}validateMCQAnswer(e){const s=[],n=[];return typeof e!="number"&&(s.push("Choice index must be a number"),n.push("Select one of the available options")),e<0&&(s.push("Choice index cannot be negative"),n.push("Select a valid option")),{isValid:s.length===0,errors:s,suggestions:n}}validateTypingAnswer(e){const s=[],n=[];return typeof e!="string"&&(s.push("Answer must be text"),n.push("Type your answer in the text field")),typeof e=="string"&&(e.trim().length===0&&(s.push("Answer cannot be empty"),n.push("Please type an answer")),e.length>500&&(s.push("Answer is too long"),n.push("Keep your answer under 500 characters"))),{isValid:s.length===0,errors:s,suggestions:n}}validateOpenAnswer(e){const s=[],n=[];return typeof e!="string"&&(s.push("Answer must be text"),n.push("Write your answer in the text area")),typeof e=="string"&&(e.trim().length===0&&(s.push("Answer cannot be empty"),n.push("Please provide an answer")),e.length>2e3&&(s.push("Answer is too long"),n.push("Keep your answer under 2000 characters")),e.trim().length<5&&n.push("Consider providing a more detailed answer")),{isValid:s.length===0,errors:s,suggestions:n}}getAvailableTracks(){return Se()}getAvailableFrameworks(e){return ke(e)}getAvailableLevels(e,s){return Ne(e,s)}getQuestionCount(e,s,n){return Ie(e,s,n)}getQuestionsByType(e,s,n,i){return Ce(e,s,n,i)}getRandomQuestionsFromBank(e,s,n,i){return Qe(e,s,n,i)}getQuestionsForSession(e){const{track:s,framework:n,level:i,mode:r}=e;let l=[];if(r==="Quiz"?l=this.getQuestionsWithCustom(s,n,i,["mcq","typing"]):l=this.getQuestionsWithCustom(s,n,i),l.length===0){const a=this.questionBank?.[s];if(a){const c=a[n];if(c){const d=c[i];d&&Array.isArray(d)&&(l=[...d])}}}if(r==="Exam"){const a=l.filter(f=>f.type==="mcq"),c=l.filter(f=>f.type==="typing"),d=l.filter(f=>f.type==="open"),g=[...this.shuffleArray(a).slice(0,Math.ceil(20*.6)),...this.shuffleArray(c).slice(0,Math.ceil(20*.3)),...this.shuffleArray(d).slice(0,Math.ceil(20*.1))];l=this.shuffleArray(g).slice(0,20)}return l}generateDailyChallenge(e,s,n){const i=this.getQuestionsForSession({track:e,framework:s,level:n,mode:"Quiz"});return this.shuffleArray(i).slice(0,10)}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getCurrentSessionData(){return this.currentSession?{...this.currentSession}:null}getSessionStats(){const e=this.sessionHistory.filter(a=>a.state===S.COMPLETED),s=this.sessionHistory.length;if(e.length===0)return{totalSessions:s,completedSessions:0,averageScore:0,totalTimeSpent:0};const n=e.reduce((a,c)=>a+c.correct.filter(Boolean).length,0),i=e.reduce((a,c)=>a+c.correct.length,0),r=i>0?n/i*100:0,l=e.reduce((a,c)=>{const d=c.startTime?Date.now()-c.startTime.getTime():0;return a+Math.max(0,d-c.totalPausedDuration)},0);return{totalSessions:s,completedSessions:e.length,averageScore:Math.round(r),totalTimeSpent:l}}validateSession(){const e=[];return this.currentSession?(this.currentSession.questions.length===0&&e.push("Session has no questions"),(this.currentSession.currentIndex<0||this.currentSession.currentIndex>=this.currentSession.questions.length)&&e.push("Invalid question index"),this.currentSession.answers.length!==this.currentSession.questions.length&&e.push("Answers array length mismatch"),this.currentSession.correct.length!==this.currentSession.questions.length&&e.push("Correct array length mismatch"),{isValid:e.length===0,errors:e}):(e.push("No active session"),{isValid:!1,errors:e})}saveSessionToStorage(){if(!this.currentSession)return!1;try{const e=JSON.stringify(this.currentSession);return localStorage.setItem("dojo-current-session",e),!0}catch(e){return console.error("Failed to save session to storage:",e),!1}}loadSessionFromStorage(){try{const e=localStorage.getItem("dojo-current-session");if(!e)return!1;const s=JSON.parse(e);return s&&s.sessionId&&s.questions&&Array.isArray(s.questions)?(s.startTime=new Date(s.startTime),s.pausedTime&&(s.pausedTime=new Date(s.pausedTime)),this.currentSession=s,!0):!1}catch(e){return console.error("Failed to load session from storage:",e),!1}}clearStoredSession(){localStorage.removeItem("dojo-current-session")}createCustomQuestion(e){const s=[],n=[];if(e.prompt?.trim()||s.push("Question prompt is required"),e.type||s.push("Question type is required"),e._track||s.push("Track is required"),e._framework||s.push("Framework is required"),e._level?.trim()||s.push("Level is required"),e.type==="mcq"&&((!e.choices||e.choices.length<2)&&s.push("MCQ questions must have at least 2 choices"),(e.answerIndex===void 0||e.answerIndex<0||e.choices&&e.answerIndex>=e.choices.length)&&s.push("MCQ questions must have a valid answer index")),e.type==="typing"&&(!e.accept||e.accept.length===0)&&s.push("Typing questions must have at least one accepted answer"),s.length>0)return{isValid:!1,errors:s,suggestions:n};const i={...e,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,_created:new Date().toISOString()};return this.customQuestions.push(i),this.saveCustomQuestions(),{isValid:!0,errors:[],suggestions:["Custom question created successfully"]}}getCustomQuestions(e,s,n){let i=[...this.customQuestions];return e&&(i=i.filter(r=>r._track===e)),s&&(i=i.filter(r=>r._framework===s)),n&&(i=i.filter(r=>r._level===n)),i}updateCustomQuestion(e,s){const n=this.customQuestions.findIndex(a=>a.id===e);if(n===-1)return{isValid:!1,errors:["Custom question not found"],suggestions:[]};const r={...this.customQuestions[n],...s},l=this.validateCustomQuestion(r);return l.isValid?(this.customQuestions[n]=r,this.saveCustomQuestions(),{isValid:!0,errors:[],suggestions:["Custom question updated successfully"]}):l}deleteCustomQuestion(e){const s=this.customQuestions.length;return this.customQuestions=this.customQuestions.filter(n=>n.id!==e),this.customQuestions.length<s?(this.saveCustomQuestions(),!0):!1}validateCustomQuestion(e){const s=[],n=[];return e.prompt?.trim()||s.push("Question prompt is required"),e.type||s.push("Question type is required"),e._track||s.push("Track is required"),e._framework||s.push("Framework is required"),e._level?.trim()||s.push("Level is required"),e.type==="mcq"&&((!e.choices||e.choices.length<2)&&s.push("MCQ questions must have at least 2 choices"),(e.answerIndex===void 0||e.answerIndex<0||e.choices&&e.answerIndex>=e.choices.length)&&s.push("MCQ questions must have a valid answer index")),e.type==="typing"&&(!e.accept||e.accept.length===0)&&s.push("Typing questions must have at least one accepted answer"),{isValid:s.length===0,errors:s,suggestions:n}}loadCustomQuestions(){try{const e=localStorage.getItem("dojo-custom-questions");if(e){const s=JSON.parse(e);Array.isArray(s)&&(this.customQuestions=s)}}catch(e){console.error("Failed to load custom questions:",e),this.customQuestions=[]}}saveCustomQuestions(){try{localStorage.setItem("dojo-custom-questions",JSON.stringify(this.customQuestions))}catch(e){console.error("Failed to save custom questions:",e)}}startQuizSession(e,s,n,i){const r=i?Math.min(Math.max(i,6),14):10;return this.startSession({track:e,framework:s,level:n,mode:"Quiz",questionCount:r})}getQuizProgress(){const e=this.getSessionProgress(),s=this.currentSession&&this.currentSession.answers&&this.currentSession.questions?this.currentSession.answers.filter(i=>i!==null).length>=this.currentSession.questions.length:!1,n=this.getSessionDuration();return{...e,isComplete:s,timeElapsed:n}}isQuizMode(){return this.currentSession?.config.mode==="Quiz"}getQuizQuestions(){return!this.currentSession||!this.isQuizMode()?[]:[...this.currentSession.questions]}getQuizResults(){if(!this.currentSession||!this.isQuizMode())return null;const{questions:e,answers:s,correct:n}=this.currentSession;if(!e||!s||!n)return null;const i=e.length,r=n.filter(Boolean).length,a=s.filter(v=>v!==null).length-r,c=s.filter(v=>v===null).length,d=i>0?r/i*100:0,g=this.getSessionDuration(),f=e.map((v,u)=>({question:v,userAnswer:s[u]??null,isCorrect:n[u]??!1,wasSkipped:(s[u]??null)===null}));return{totalQuestions:i,correctAnswers:r,incorrectAnswers:a,skippedQuestions:c,scorePct:d,timeElapsed:g,questionsWithAnswers:f}}startStudySession(e,s,n){return this.startSession({track:e,framework:s,level:n,mode:"Study"})}isStudyMode(){return this.currentSession?.config.mode==="Study"}getStudyQuestions(){return!this.currentSession||!this.isStudyMode()?[]:[...this.currentSession.questions]}getStudyProgress(){if(!this.currentSession||!this.isStudyMode())return{current:0,total:0,viewed:0,completionRate:0,timeElapsed:0};const{currentIndex:e,questions:s,answers:n}=this.currentSession;if(!s||!n)return{current:0,total:0,viewed:0,completionRate:0,timeElapsed:0};const i=n.filter(a=>a!==null).length,r=s.length>0?i/s.length*100:0,l=this.getSessionDuration();return{current:e,total:s.length,viewed:i,completionRate:r,timeElapsed:l}}getCurrentQuestionWithAnswer(){if(!this.currentSession||!this.isStudyMode())return{question:null,explanation:null,hasNext:!1,hasPrevious:!1,index:0,total:0};const e=this.getCurrentQuestion(),{currentIndex:s,questions:n}=this.currentSession;return{question:e,explanation:e?.explanation||null,hasNext:this.hasNextQuestion(),hasPrevious:this.hasPreviousQuestion(),index:s,total:n?.length||0}}markQuestionAsViewed(){if(!this.currentSession||!this.isStudyMode())return;const{currentIndex:e,answers:s}=this.currentSession;!s||e<0||e>=s.length||(s[e]="viewed")}getStudySessionSummary(){if(!this.currentSession||!this.isStudyMode())return null;const{questions:e,answers:s}=this.currentSession;if(!e||!s)return null;const n=e.length,i=s.filter(a=>a!==null).length,r=this.getSessionDuration(),l=e.map((a,c)=>({question:a,wasViewed:s[c]!==null,explanation:a.explanation||null}));return{totalQuestions:n,viewedQuestions:i,timeSpent:r,questionsWithDetails:l}}nextQuestionInStudy(){return this.isStudyMode()?(this.markQuestionAsViewed(),this.nextQuestion()):{success:!1,error:"Not in study mode",currentIndex:-1,totalQuestions:0}}previousQuestionInStudy(){return this.isStudyMode()?this.previousQuestion():{success:!1,error:"Not in study mode",currentIndex:-1,totalQuestions:0}}jumpToQuestionInStudy(e){return this.isStudyMode()?(this.markQuestionAsViewed(),this.jumpToQuestion(e)):{success:!1,error:"Not in study mode",currentIndex:-1,totalQuestions:0}}clearAllCustomQuestions(){this.customQuestions=[],localStorage.removeItem("dojo-custom-questions")}getQuestionsWithCustom(e,s,n,i){const r=M(e,s,n),a=this.getCustomQuestions(e,s,n).map(d=>{const g={id:d.id,type:d.type,prompt:d.prompt,explanation:d.explanation};return d.type==="mcq"?{...g,type:"mcq",choices:d.choices||[],answerIndex:d.answerIndex||0}:d.type==="typing"?{...g,type:"typing",accept:d.accept||[]}:{...g,type:"open",rubric:d.rubric}}),c=[...r,...a];return i?c.filter(d=>i.includes(d.type)):c}exportUserData(){const e=this.getSessionHistory().map(s=>({date:s.startTime.toISOString().split("T")[0],track:s.config.track,framework:s.config.framework,level:s.config.level,scorePct:Math.round(s.correct.filter(Boolean).length/s.questions.length*100),total:s.questions.length,correct:s.correct.filter(Boolean).length,mode:s.config.mode}));return{entries:e,customQuestions:this.customQuestions,preferences:{defaultTrack:"EN",defaultFramework:"Classic",defaultLevel:"Beginner",enableDictionary:!0,enableCustomQuestions:!0},statistics:{totalSessions:e.length,totalQuestions:e.reduce((s,n)=>s+n.total,0),averageScore:e.length>0?e.reduce((s,n)=>s+n.scorePct,0)/e.length:0,streakDays:0,lastActivity:e.length>0?e[e.length-1].date:""}}}importUserData(e){const s=[],n=[];try{if((!e.customQuestions||!Array.isArray(e.customQuestions))&&s.push("Invalid custom questions data"),(!e.entries||!Array.isArray(e.entries))&&s.push("Invalid progress entries data"),s.length>0)return{isValid:!1,errors:s,suggestions:n};const i=new Set(this.customQuestions.map(l=>l.id)),r=e.customQuestions.filter(l=>!i.has(l.id));return this.customQuestions.push(...r),this.saveCustomQuestions(),n.push(`Imported ${r.length} new custom questions`),n.push(`Imported ${e.entries.length} progress entries`),{isValid:!0,errors:[],suggestions:n}}catch(i){return{isValid:!1,errors:["Failed to import user data: "+i.message],suggestions:[]}}}}const O=h.createContext(void 0),_e=()=>{const o=h.useContext(O);if(o===void 0)throw new Error("useTheme must be used within a ThemeProvider");return o},qe=({children:o})=>{const[e,s]=h.useState("system"),[n,i]=h.useState("light");h.useEffect(()=>{const l=localStorage.getItem("theme");l&&["system","light","dark"].includes(l)&&s(l)},[]),h.useEffect(()=>{localStorage.setItem("theme",e)},[e]),h.useEffect(()=>{const l=()=>{if(e==="system"){const a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i(a)}else i(e)};if(l(),e==="system"){const a=window.matchMedia("(prefers-color-scheme: dark)");return a.addEventListener("change",l),()=>a.removeEventListener("change",l)}},[e]),h.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]);const r={theme:e,setTheme:s,resolvedTheme:n};return t.jsx(O.Provider,{value:r,children:o})};class Ae{constructor(){C(this,"events",[]);C(this,"maxEvents",1e3)}track(e,s){const n={event:e,properties:s||{},timestamp:Date.now()};this.events.push(n),this.events.length>this.maxEvents&&(this.events=this.events.slice(-this.maxEvents));try{localStorage.setItem("sakulang-analytics",JSON.stringify(this.events))}catch(i){console.warn("Failed to save analytics data:",i)}}trackPageView(e){this.track("page_view",{page:e})}trackSessionStart(e){this.track("session_start",e)}trackSessionComplete(e){this.track("session_complete",e)}trackError(e,s){this.track("error",{error:e,context:s})}getEvents(){return[...this.events]}clearEvents(){this.events=[],localStorage.removeItem("sakulang-analytics")}init(){try{const e=localStorage.getItem("sakulang-analytics");e&&(this.events=JSON.parse(e))}catch(e){console.warn("Failed to load analytics data:",e)}}}const _=new Ae;_.init();class Ee{constructor(){C(this,"state",{user:null,isLoading:!1});C(this,"listeners",[]);this.loadUser()}loadUser(){try{const e=localStorage.getItem("sakulang-user");if(e){const s=JSON.parse(e);this.state.user=s,this.notifyListeners()}}catch(e){console.warn("Failed to load user data:",e)}}saveUser(e){try{localStorage.setItem("sakulang-user",JSON.stringify(e)),this.state.user=e,this.notifyListeners()}catch(s){console.warn("Failed to save user data:",s)}}notifyListeners(){this.listeners.forEach(e=>e(this.state))}loginAsGuest(){const e={id:`guest_${Date.now()}`,username:`ผู้เรียน${Math.floor(Math.random()*1e3)}`,type:"guest",createdAt:new Date().toISOString()};return this.saveUser(e),e}logout(){localStorage.removeItem("sakulang-user"),this.state.user=null,this.notifyListeners()}getCurrentUser(){return this.state.user}isAuthenticated(){return this.state.user!==null}subscribe(e){return this.listeners.push(e),()=>{const s=this.listeners.indexOf(e);s>-1&&this.listeners.splice(s,1)}}getState(){return{...this.state}}}const q=new Ee,Pe=()=>{const[o,e]=h.useState(q.getState());return h.useEffect(()=>q.subscribe(e),[]),{user:o.user,isLoading:o.isLoading,isAuthenticated:q.isAuthenticated(),loginAsGuest:()=>q.loginAsGuest(),logout:()=>q.logout()}},De={tagline:{th:"แพลตฟอร์มเรียนภาษาฟรี",en:"Free Language Learning Platform"},settings:{th:"การตั้งค่า",en:"Settings"},progress:{th:"ความคืบหน้า",en:"Progress"},start:{th:"เริ่มเรียน",en:"Start Learning"},quiz:{th:"แบบทดสอบ",en:"Quiz"},study:{th:"ศึกษา",en:"Study"},exam:{th:"สอบ",en:"Exam"},read:{th:"อ่าน",en:"Read"},write:{th:"เขียน",en:"Write"},english:{th:"ภาษาอังกฤษ",en:"English"},japanese:{th:"ภาษาญี่ปุ่น",en:"Japanese"},beginner:{th:"เริ่มต้น",en:"Beginner"},intermediate:{th:"กลาง",en:"Intermediate"},advanced:{th:"สูง",en:"Advanced"},expert:{th:"ผู้เชี่ยวชาญ",en:"Expert"},score:{th:"คะแนน",en:"Score"},correct:{th:"ถูก",en:"Correct"},incorrect:{th:"ผิด",en:"Incorrect"},total:{th:"รวม",en:"Total"},next:{th:"ถัดไป",en:"Next"},previous:{th:"ก่อนหน้า",en:"Previous"},skip:{th:"ข้าม",en:"Skip"},finish:{th:"เสร็จสิ้น",en:"Finish"},back:{th:"กลับ",en:"Back"},save:{th:"บันทึก",en:"Save"},cancel:{th:"ยกเลิก",en:"Cancel"},loading:{th:"กำลังโหลด...",en:"Loading..."},error:{th:"เกิดข้อผิดพลาด",en:"An error occurred"}},Me=()=>{const o="th";return{t:n=>{const i=De[n];return i?i[o]||i.th||n:(console.warn(`Translation missing for key: ${n}`),n)},currentLanguage:o,setLanguage:n=>{console.log("Language switching not yet implemented:",n)}}},We=({onComplete:o})=>{const[e,s]=h.useState(12),[n,i]=h.useState(navigator.onLine);return h.useEffect(()=>{const r=()=>i(!0),l=()=>i(!1);return window.addEventListener("online",r),window.addEventListener("offline",l),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",l)}},[]),h.useEffect(()=>{const r=[12,28,56,86,92,100];let l=0;const a=setInterval(()=>{l<r.length-1?(l++,s(r[l]||100)):(clearInterval(a),setTimeout(o,100))},50);return()=>clearInterval(a)},[o]),t.jsxs("div",{role:"status","aria-label":"กำลังโหลด",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#0F172A",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,color:"#E5E7EB",fontFamily:"Inter, sans-serif"},children:[t.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"bold",marginBottom:"2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"🎌 SAKULANG"}),t.jsx("div",{style:{width:"200px",height:"4px",backgroundColor:"#334155",borderRadius:"2px",overflow:"hidden",marginBottom:"1rem"},children:t.jsx("div",{style:{width:`${e}%`,height:"100%",backgroundColor:"#10B981",borderRadius:"2px",transition:"width 0.3s ease"}})}),t.jsxs("div",{style:{fontSize:"0.875rem",color:"#94A3B8",marginBottom:"0.5rem"},children:[e,"% · กำลังเตรียมระบบ…"]}),!n&&t.jsx("div",{style:{fontSize:"0.75rem",color:"#F59E0B",backgroundColor:"#451A03",padding:"0.25rem 0.5rem",borderRadius:"0.25rem",border:"1px solid #92400E"},children:"· ออฟไลน์"})]})},Le=({onStartSession:o,onShowProgress:e,progressCount:s})=>{const[n,i]=h.useState("EN"),[r,l]=h.useState("Classic"),[a,c]=h.useState("Beginner"),[d,g]=h.useState("Quiz"),f=p=>p==="EN"?["Classic","CEFR"]:p==="JP"?["Classic","JLPT"]:["Classic"],v=p=>{switch(p){case"CEFR":return["A1","A2","B1","B2","C1","C2"];case"JLPT":return["N5","N4","N3","N2","N1"];case"Classic":default:return["Beginner","Intermediate","Advanced","Expert"]}},u=p=>{i(p);const j=f(p);if(j.length>0){l(j[0]);const N=v(j[0]);N.length>0&&c(N[0])}},y=p=>{l(p);const j=v(p);j.length>0&&c(j[0])},b=()=>{o({track:n,framework:r,level:a,mode:d})};return t.jsxs("div",{className:"start-screen",children:[t.jsxs("div",{className:"welcome-section",children:[t.jsx("h2",{children:"เริ่มเรียนรู้ภาษา"}),t.jsx("p",{children:"เลือกแทร็ก หลักสูตร และระดับที่เหมาะกับคุณ"})]}),t.jsxs("div",{className:"selection-grid",children:[t.jsxs("div",{className:"selection-group",children:[t.jsx("label",{className:"selection-label",children:"ภาษา (Track)"}),t.jsxs("div",{className:"button-group",children:[t.jsx("button",{type:"button",className:`btn ${n==="EN"?"btn-primary":"btn-secondary"}`,onClick:()=>u("EN"),children:"🇺🇸 English"}),t.jsx("button",{type:"button",className:`btn ${n==="JP"?"btn-primary":"btn-secondary"}`,onClick:()=>u("JP"),children:"🇯🇵 Japanese"})]})]}),t.jsxs("div",{className:"selection-group",children:[t.jsx("label",{className:"selection-label",children:"หลักสูตร (Framework)"}),t.jsx("div",{className:"button-group",children:f(n).map(p=>t.jsx("button",{type:"button",className:`btn ${r===p?"btn-primary":"btn-secondary"}`,onClick:()=>y(p),children:p},p))})]}),t.jsxs("div",{className:"selection-group",children:[t.jsx("label",{className:"selection-label",children:"ระดับ (Level)"}),t.jsx("div",{className:"button-group",children:v(r).map(p=>t.jsx("button",{type:"button",className:`btn ${a===p?"btn-primary":"btn-secondary"}`,onClick:()=>c(p),children:p},p))})]}),t.jsxs("div",{className:"selection-group",children:[t.jsx("label",{className:"selection-label",children:"โหมดการเรียน (Mode)"}),t.jsx("div",{className:"button-group",children:["Quiz","Study","Exam","Read","Write"].map(p=>t.jsx("button",{type:"button",className:`btn ${d===p?"btn-primary":"btn-secondary"}`,onClick:()=>g(p),children:p},p))})]})]}),t.jsxs("div",{className:"action-section",children:[t.jsx("button",{type:"button",className:"btn btn-primary btn-lg start-btn",onClick:b,children:"🚀 เริ่มเรียน"}),t.jsx("div",{className:"secondary-actions",children:t.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:e,children:["📊 ดูความคืบหน้า (",s,")"]})})]}),t.jsxs("div",{className:"daily-challenge",children:[t.jsx("h3",{children:"🎯 Daily Challenge"}),t.jsx("p",{children:"ทำแบบทดสอบ 10 ข้อ ประจำวัน"}),t.jsx("button",{type:"button",className:"btn btn-accent",onClick:()=>o({track:n,framework:r,level:a,mode:"Quiz",questionCount:10}),children:"เริ่ม Daily Challenge"})]})]})},Je=({engine:o,onFinish:e,onExit:s})=>{const[n,i]=h.useState(null),[r,l]=h.useState(""),[a,c]=h.useState(-1),[d,g]=h.useState(!1),[f,v]=h.useState(!1),[u,y]=h.useState({current:0,total:0,correct:0}),[b,p]=h.useState(null),[j,N]=h.useState(!1);h.useEffect(()=>{T(),N(o.isStudyMode())},[]);const T=()=>{const m=o.getCurrentQuestion(),w=o.getSessionProgress();i(m),y(w),g(!1),l(""),c(-1),p(null)},E=m=>{if(d)return;c(m);const w=o.answerMCQ(m);typeof w=="object"&&"isCorrect"in w?(v(w.isCorrect),p(w)):(v(w),p({isCorrect:w})),g(!0);const H=o.getSessionProgress();y(H)},x=()=>{if(d||!r.trim())return;const m=o.answerTyping(r.trim());typeof m=="object"&&"isCorrect"in m?(v(m.isCorrect),p(m)):(v(m),p({isCorrect:m})),g(!0);const w=o.getSessionProgress();y(w)},k=()=>{if(d)return;const m=o.answerOpen(r);typeof m=="object"&&"isCorrect"in m?(v(m.isCorrect),p(m)):(v(!0),p({isCorrect:!0})),g(!0);const w=o.getSessionProgress();y(w)},R=()=>{const m=o.nextQuestion();typeof m=="object"&&"success"in m?m.success?T():m.isLastQuestion&&e():o.hasNextQuestion()?T():e()},U=()=>{o.pauseSession()},W=()=>{const m=o.skipQuestion();typeof m=="object"&&"success"in m?m.success&&(T(),m.isLastQuestion&&setTimeout(()=>e(),1e3)):o.hasNextQuestion()?T():e()},B=m=>{m.key==="Enter"&&n?.type==="typing"&&!d&&x()};if(!n)return t.jsx("div",{className:"question-screen",children:t.jsx("div",{className:"loading",children:t.jsx("p",{children:"กำลังโหลดคำถาม..."})})});const F=u.total>0?u.current/u.total*100:0;return t.jsxs("div",{className:"question-screen",children:[t.jsxs("div",{className:"question-header",children:[t.jsxs("div",{className:"progress-info",children:[t.jsxs("span",{className:"question-counter",children:[u.current," / ",u.total]}),j?t.jsx("span",{className:"mode-indicator study",children:"📚 Study Mode"}):t.jsxs("span",{className:"score",children:["คะแนน: ",u.correct,"/",u.current]})]}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${F}%`}})}),t.jsxs("div",{className:"header-controls",children:[t.jsx("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:U,disabled:!o.isSessionActive(),children:"⏸️ หยุดชั่วคราว"}),t.jsx("button",{type:"button",className:"btn btn-secondary btn-sm exit-btn",onClick:s,children:"ออก"})]})]}),t.jsxs("div",{className:"question-content",children:[t.jsx("div",{className:"question-prompt",children:t.jsx("h2",{children:n.prompt})}),n.type==="mcq"&&t.jsx("div",{className:"mcq-choices",children:n.choices.map((m,w)=>t.jsxs("button",{type:"button",className:`choice-btn ${a===w?"selected":""} ${d&&w===n.answerIndex?"correct":d&&a===w&&!f?"incorrect":""}`,onClick:()=>E(w),disabled:d,children:[t.jsx("span",{className:"choice-letter",children:String.fromCharCode(65+w)}),t.jsx("span",{className:"choice-text",children:m})]},w))}),n.type==="typing"&&t.jsxs("div",{className:"typing-input",children:[t.jsx("input",{type:"text",value:r,onChange:m=>l(m.target.value),onKeyPress:B,placeholder:n.placeholder||"พิมพ์คำตอบของคุณ...",className:`typing-field ${d?f?"correct":"incorrect":""}`,disabled:d}),!d&&t.jsx("button",{type:"button",className:"btn btn-primary submit-btn",onClick:x,disabled:!r.trim(),children:"ส่งคำตอบ"}),d&&t.jsxs("div",{className:"accepted-answers",children:[t.jsx("p",{children:t.jsx("strong",{children:"คำตอบที่ถูกต้อง:"})}),t.jsx("ul",{children:n.accept.map((m,w)=>t.jsx("li",{children:m},w))})]})]}),n.type==="open"&&t.jsxs("div",{className:"open-input",children:[t.jsx("textarea",{value:r,onChange:m=>l(m.target.value),placeholder:"เขียนคำตอบของคุณ...",className:"open-field",rows:6,disabled:d}),!d&&t.jsx("button",{type:"button",className:"btn btn-primary submit-btn",onClick:k,children:"ส่งคำตอบ"})]}),d&&t.jsxs("div",{className:`feedback ${f?"correct":"incorrect"} ${j?"study-mode":""}`,children:[n.type!=="open"&&t.jsxs("div",{className:"feedback-result",children:[f?t.jsx("span",{className:"result-icon correct",children:"✅ ถูกต้อง!"}):t.jsx("span",{className:"result-icon incorrect",children:"❌ ไม่ถูกต้อง"}),j&&t.jsx("span",{className:"study-badge",children:"📚 Study Mode"})]}),j&&b&&b.feedback&&t.jsxs("div",{className:"study-feedback",children:[t.jsx("h4",{children:"💡 คำแนะนำ:"}),t.jsx("p",{children:b.feedback})]}),j&&!f&&b&&b.correctAnswer&&t.jsxs("div",{className:"correct-answer",children:[t.jsx("h4",{children:"✅ คำตอบที่ถูกต้อง:"}),t.jsx("p",{children:t.jsx("strong",{children:b.correctAnswer})})]}),n.explanation&&t.jsxs("div",{className:"explanation",children:[t.jsx("h4",{children:j?"📖 คำอธิบายเพิ่มเติม:":"คำอธิบาย:"}),t.jsx("p",{children:n.explanation})]}),n.type==="open"&&n.rubric&&t.jsxs("div",{className:"rubric",children:[t.jsx("h4",{children:"เกณฑ์การประเมิน:"}),t.jsx("ul",{children:n.rubric.map((m,w)=>t.jsx("li",{children:m},w))})]}),j&&t.jsx("div",{className:"study-tips",children:t.jsx("p",{children:t.jsx("em",{children:"💡 ใน Study Mode คุณสามารถดูคำอธิบายทันทีเพื่อการเรียนรู้ที่ดีขึ้น"})})})]})]}),d&&t.jsxs("div",{className:"question-navigation",children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:W,children:"ข้าม"}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:R,children:o.hasNextQuestion()?"ถัดไป":"เสร็จสิ้น"})]}),!d&&n.type!=="open"&&t.jsx("div",{className:"question-navigation",children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:W,children:"ข้าม"})})]})},ze=({progress:o,onRestart:e,onShowProgress:s})=>{const n=Math.round(o.scorePct),i=n>=70,r=n===100,l=()=>r?"🏆":n>=90?"🌟":n>=80?"🎉":n>=70?"👍":n>=60?"📚":"💪",a=()=>r?"สมบูรณ์แบบ!":n>=90?"ยอดเยี่ยม!":n>=80?"ดีมาก!":n>=70?"ดี!":n>=60?"พอใช้":"ต้องฝึกฝนเพิ่มเติม",c=d=>new Date(d).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"result-screen",children:[t.jsx("div",{className:"result-header",children:t.jsxs("div",{className:"score-display",children:[t.jsx("div",{className:"score-emoji",children:l()}),t.jsxs("div",{className:"score-text",children:[t.jsxs("h1",{className:"score-percentage",children:[n,"%"]}),t.jsx("p",{className:"score-message",children:a()})]})]})}),t.jsxs("div",{className:"result-details",children:[t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:o.correct}),t.jsx("div",{className:"stat-label",children:"ถูก"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:o.total-o.correct}),t.jsx("div",{className:"stat-label",children:"ผิด"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:o.total}),t.jsx("div",{className:"stat-label",children:"รวม"})]})]}),t.jsxs("div",{className:"session-info",children:[t.jsxs("div",{className:"info-row",children:[t.jsx("span",{className:"info-label",children:"ภาษา:"}),t.jsx("span",{className:"info-value",children:o.track==="EN"?"🇺🇸 English":"🇯🇵 Japanese"})]}),t.jsxs("div",{className:"info-row",children:[t.jsx("span",{className:"info-label",children:"หลักสูตร:"}),t.jsx("span",{className:"info-value",children:o.framework})]}),t.jsxs("div",{className:"info-row",children:[t.jsx("span",{className:"info-label",children:"ระดับ:"}),t.jsx("span",{className:"info-value",children:o.level})]}),t.jsxs("div",{className:"info-row",children:[t.jsx("span",{className:"info-label",children:"โหมด:"}),t.jsx("span",{className:"info-value",children:o.mode})]}),t.jsxs("div",{className:"info-row",children:[t.jsx("span",{className:"info-label",children:"เวลา:"}),t.jsx("span",{className:"info-value",children:c(o.date)})]})]})]}),t.jsxs("div",{className:"result-progress",children:[t.jsx("div",{className:"progress-bar-container",children:t.jsx("div",{className:`progress-bar-fill ${i?"good-score":"needs-improvement"}`,style:{width:`${n}%`}})}),t.jsxs("div",{className:"progress-labels",children:[t.jsx("span",{children:"0%"}),t.jsx("span",{children:"50%"}),t.jsx("span",{children:"100%"})]})]}),t.jsxs("div",{className:"recommendations",children:[r&&t.jsxs("div",{className:"recommendation perfect",children:[t.jsx("h3",{children:"🎯 แนะนำ"}),t.jsx("p",{children:"คุณทำได้ดีมาก! ลองเพิ่มระดับความยากหรือเปลี่ยนโหมดการเรียนดู"})]}),i&&!r&&t.jsxs("div",{className:"recommendation good",children:[t.jsx("h3",{children:"📈 แนะนำ"}),t.jsx("p",{children:"คะแนนดี! ลองทำแบบทดสอบเพิ่มเติมเพื่อเสริมความแข็งแกร่ง"})]}),!i&&t.jsxs("div",{className:"recommendation needs-work",children:[t.jsx("h3",{children:"💡 แนะนำ"}),t.jsx("p",{children:"ลองใช้โหมด Study เพื่อทบทวนเนื้อหาก่อนทำแบบทดสอบอีกครั้ง"})]})]}),t.jsxs("div",{className:"result-actions",children:[t.jsx("button",{type:"button",className:"btn btn-primary btn-lg",onClick:e,children:"🔄 ทำใหม่"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:s,children:"📊 ดูความคืบหน้า"})]}),t.jsxs("div",{className:"share-section",children:[t.jsx("p",{className:"share-text",children:"แชร์ผลลัพธ์ของคุณ"}),t.jsx("div",{className:"share-buttons",children:t.jsx("button",{type:"button",className:"btn btn-outline share-btn",onClick:()=>{const d=`ฉันได้คะแนน ${n}% ใน ${o.framework} ${o.level} (${o.mode}) บน SAKULANG! 🎌`;navigator.share?navigator.share({text:d}):(navigator.clipboard.writeText(d),alert("คัดลอกข้อความแล้ว!"))},children:"📱 แชร์"})})]})]})},Oe=({progressHistory:o,onBack:e,onClearHistory:s})=>{const[n,i]=h.useState("all"),[r,l]=h.useState("all"),a=o.filter(u=>{const y=n==="all"||u.track===n,b=r==="all"||u.mode===r;return y&&b}),c={totalSessions:a.length,averageScore:a.length>0?Math.round(a.reduce((u,y)=>u+y.scorePct,0)/a.length):0,totalQuestions:a.reduce((u,y)=>u+y.total,0),totalCorrect:a.reduce((u,y)=>u+y.correct,0),bestScore:a.length>0?Math.max(...a.map(u=>u.scorePct)):0,recentStreak:d(a)};function d(u){if(u.length===0)return 0;const y=[...u].sort((j,N)=>new Date(N.date).getTime()-new Date(j.date).getTime());let b=0;const p=new Date;for(const j of y){const N=new Date(j.date);if(Math.floor((p.getTime()-N.getTime())/(1e3*60*60*24))<=b+1)b++;else break}return b}const g=u=>new Date(u).toLocaleDateString("th-TH",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=u=>u>=90?"excellent":u>=80?"good":u>=70?"fair":"needs-work",v=()=>{const u={exportDate:new Date().toISOString(),progressHistory:o,statistics:c},y=new Blob([JSON.stringify(u,null,2)],{type:"application/json"}),b=URL.createObjectURL(y),p=document.createElement("a");p.href=b,p.download=`sakulang-progress-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(b)};return t.jsxs("div",{className:"progress-screen",children:[t.jsxs("div",{className:"progress-header",children:[t.jsx("button",{type:"button",className:"btn btn-secondary btn-sm back-btn",onClick:e,children:"← กลับ"}),t.jsx("h1",{children:"📊 ความคืบหน้า"}),t.jsx("button",{type:"button",className:"btn btn-outline btn-sm export-btn",onClick:v,children:"📤 ส่งออก"})]}),t.jsxs("div",{className:"stats-overview",children:[t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-value",children:c.totalSessions}),t.jsx("div",{className:"stat-label",children:"เซสชัน"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsxs("div",{className:"stat-value",children:[c.averageScore,"%"]}),t.jsx("div",{className:"stat-label",children:"คะแนนเฉลี่ย"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsxs("div",{className:"stat-value",children:[c.bestScore,"%"]}),t.jsx("div",{className:"stat-label",children:"คะแนนสูงสุด"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-value",children:c.recentStreak}),t.jsx("div",{className:"stat-label",children:"วันติดต่อกัน"})]})]}),t.jsxs("div",{className:"accuracy-display",children:[t.jsxs("div",{className:"accuracy-text",children:["ความแม่นยำ: ",c.totalQuestions>0?Math.round(c.totalCorrect/c.totalQuestions*100):0,"%"]}),t.jsxs("div",{className:"accuracy-detail",children:["(",c.totalCorrect,"/",c.totalQuestions," ข้อ)"]})]})]}),t.jsxs("div",{className:"progress-filters",children:[t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{children:"ภาษา:"}),t.jsxs("select",{value:n,onChange:u=>i(u.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"ทั้งหมด"}),t.jsx("option",{value:"EN",children:"🇺🇸 English"}),t.jsx("option",{value:"JP",children:"🇯🇵 Japanese"})]})]}),t.jsxs("div",{className:"filter-group",children:[t.jsx("label",{children:"โหมด:"}),t.jsxs("select",{value:r,onChange:u=>l(u.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"ทั้งหมด"}),t.jsx("option",{value:"Quiz",children:"Quiz"}),t.jsx("option",{value:"Study",children:"Study"}),t.jsx("option",{value:"Exam",children:"Exam"}),t.jsx("option",{value:"Read",children:"Read"}),t.jsx("option",{value:"Write",children:"Write"})]})]})]}),t.jsxs("div",{className:"progress-history",children:[t.jsx("h2",{children:"ประวัติการเรียน"}),a.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("p",{children:"ยังไม่มีข้อมูลความคืบหน้า"}),t.jsx("p",{children:"เริ่มทำแบบทดสอบเพื่อดูผลลัพธ์ที่นี่"})]}):t.jsx("div",{className:"history-list",children:a.sort((u,y)=>new Date(y.date).getTime()-new Date(u.date).getTime()).map((u,y)=>t.jsxs("div",{className:"history-item",children:[t.jsxs("div",{className:"history-main",children:[t.jsxs("div",{className:"history-info",children:[t.jsxs("div",{className:"history-title",children:[u.track==="EN"?"🇺🇸":"🇯🇵"," ",u.framework," ",u.level]}),t.jsxs("div",{className:"history-meta",children:[u.mode," • ",g(u.date)]})]}),t.jsxs("div",{className:"history-score",children:[t.jsxs("div",{className:`score-badge ${f(u.scorePct)}`,children:[Math.round(u.scorePct),"%"]}),t.jsxs("div",{className:"score-detail",children:[u.correct,"/",u.total]})]})]}),t.jsx("div",{className:"history-progress",children:t.jsx("div",{className:"progress-bar-mini",children:t.jsx("div",{className:`progress-fill-mini ${f(u.scorePct)}`,style:{width:`${u.scorePct}%`}})})})]},y))})]}),o.length>0&&t.jsxs("div",{className:"danger-zone",children:[t.jsx("h3",{children:"⚠️ ลบข้อมูล"}),t.jsx("p",{children:"การดำเนินการนี้จะลบประวัติการเรียนทั้งหมด และไม่สามารถกู้คืนได้"}),t.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>{confirm("คุณแน่ใจหรือไม่ที่จะลบประวัติการเรียนทั้งหมด?")&&s()},children:"🗑️ ลบประวัติทั้งหมด"})]})]})},Re=()=>{const{theme:o,setTheme:e,resolvedTheme:s}=_e(),n=[{value:"system",label:"System",icon:"🖥️"},{value:"dark",label:"Dark",icon:"🌙"},{value:"light",label:"Light",icon:"☀️"}];return t.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",borderRadius:"var(--radius-lg)",border:"1px solid var(--border)"},children:[t.jsx("h3",{style:{margin:"0 0 1rem 0",color:"var(--fg-0)",fontSize:"1.125rem",fontWeight:"600"},children:"Appearance"}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:n.map(({value:i,label:r,icon:l})=>t.jsxs("button",{onClick:()=>e(i),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:o===i?"var(--pri-500)":"transparent",color:o===i?"white":"var(--fg-0)",border:"1px solid",borderColor:o===i?"var(--pri-500)":"var(--border)",borderRadius:"var(--radius-md)",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:a=>{o!==i&&(a.currentTarget.style.backgroundColor="var(--surface-hover)")},onMouseLeave:a=>{o!==i&&(a.currentTarget.style.backgroundColor="transparent")},children:[t.jsx("span",{children:l}),t.jsx("span",{children:r}),i==="system"&&t.jsxs("span",{style:{fontSize:"0.75rem",opacity:.7},children:["(",s,")"]})]},i))}),t.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.75rem",color:"var(--fg-muted)",lineHeight:"1.4"},children:"Choose your preferred theme. System will follow your device settings."})]})},Ue=({onBack:o})=>{const[e,s]=h.useState({enableDictionary:!0,enableCustomQuestions:!0,enableAnimations:!0,enableSounds:!1,autoSave:!0,showTips:!0,language:"th",theme:"system"});h.useEffect(()=>{const c=localStorage.getItem("sakulang-settings");if(c)try{const d=JSON.parse(c);s(g=>({...g,...d}))}catch(d){console.error("Failed to load settings:",d)}},[]);const n=c=>{s(c),localStorage.setItem("sakulang-settings",JSON.stringify(c))},i=(c,d)=>{const g={...e,[c]:d};n(g)},r=()=>{confirm("คุณแน่ใจหรือไม่ที่จะรีเซ็ตการตั้งค่าทั้งหมด?")&&n({enableDictionary:!0,enableCustomQuestions:!0,enableAnimations:!0,enableSounds:!1,autoSave:!0,showTips:!0,language:"th",theme:"system"})},l=()=>{const c={exportDate:new Date().toISOString(),settings:e,version:"2.0"},d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),g=URL.createObjectURL(d),f=document.createElement("a");f.href=g,f.download=`sakulang-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(g)},a=c=>{const d=c.target.files?.[0];if(!d)return;const g=new FileReader;g.onload=f=>{try{const v=JSON.parse(f.target?.result);v.settings&&(n({...e,...v.settings}),alert("นำเข้าการตั้งค่าสำเร็จ!"))}catch{alert("ไฟล์การตั้งค่าไม่ถูกต้อง")}},g.readAsText(d)};return t.jsxs("div",{className:"settings-screen",children:[t.jsxs("div",{className:"settings-header",children:[t.jsx("button",{type:"button",className:"btn btn-secondary btn-sm back-btn",onClick:o,children:"← กลับ"}),t.jsx("h1",{children:"⚙️ การตั้งค่า"})]}),t.jsxs("div",{className:"settings-content",children:[t.jsxs("div",{className:"settings-section",children:[t.jsx("h2",{children:"🎓 การเรียนรู้"}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"เปิดใช้พจนานุกรม"}),t.jsx("p",{className:"setting-description",children:"แสดงความหมายคำเมื่อเลื่อนเมาส์ผ่าน"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.enableDictionary,onChange:c=>i("enableDictionary",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"เปิดใช้คำถามที่กำหนดเอง"}),t.jsx("p",{className:"setting-description",children:"รวมคำถามที่คุณสร้างเองในแบบทดสอบ"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.enableCustomQuestions,onChange:c=>i("enableCustomQuestions",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"แสดงคำแนะนำ"}),t.jsx("p",{className:"setting-description",children:"แสดงคำแนะนำการใช้งานสำหรับผู้ใช้ใหม่"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.showTips,onChange:c=>i("showTips",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsx("h2",{children:"🎨 หน้าตา"}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"ธีม"}),t.jsx("p",{className:"setting-description",children:"เลือกธีมสีของแอปพลิเคชัน"})]}),t.jsx(Re,{})]}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"เปิดใช้แอนิเมชัน"}),t.jsx("p",{className:"setting-description",children:"แสดงเอฟเฟกต์การเคลื่อนไหว"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.enableAnimations,onChange:c=>i("enableAnimations",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"ภาษาของแอป"}),t.jsx("p",{className:"setting-description",children:"เลือกภาษาที่ใช้ในส่วนติดต่อผู้ใช้"})]}),t.jsxs("select",{value:e.language,onChange:c=>i("language",c.target.value),className:"setting-select",children:[t.jsx("option",{value:"th",children:"🇹🇭 ไทย"}),t.jsx("option",{value:"en",children:"🇺🇸 English"})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsx("h2",{children:"💾 ระบบ"}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"บันทึกอัตโนมัติ"}),t.jsx("p",{className:"setting-description",children:"บันทึกความคืบหน้าโดยอัตโนมัติ"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.autoSave,onChange:c=>i("autoSave",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]}),t.jsxs("div",{className:"setting-item",children:[t.jsxs("div",{className:"setting-info",children:[t.jsx("label",{className:"setting-label",children:"เปิดใช้เสียง"}),t.jsx("p",{className:"setting-description",children:"เล่นเสียงเมื่อตอบถูกหรือผิด"})]}),t.jsxs("label",{className:"toggle-switch",children:[t.jsx("input",{type:"checkbox",checked:e.enableSounds,onChange:c=>i("enableSounds",c.target.checked)}),t.jsx("span",{className:"toggle-slider"})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsx("h2",{children:"📊 จัดการข้อมูล"}),t.jsxs("div",{className:"setting-actions",children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"📤 ส่งออกการตั้งค่า"}),t.jsxs("label",{className:"btn btn-secondary file-input-label",children:["📥 นำเข้าการตั้งค่า",t.jsx("input",{type:"file",accept:".json",onChange:a,style:{display:"none"}})]}),t.jsx("button",{type:"button",className:"btn btn-danger",onClick:r,children:"🔄 รีเซ็ตการตั้งค่า"})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsx("h2",{children:"ℹ️ เกี่ยวกับ"}),t.jsxs("div",{className:"about-info",children:[t.jsxs("div",{className:"app-info",children:[t.jsx("h3",{children:"🎌 SAKULANG"}),t.jsx("p",{children:"แพลตฟอร์มเรียนภาษาฟรี"}),t.jsx("p",{children:"เวอร์ชัน 2.0"})]}),t.jsxs("div",{className:"links",children:[t.jsx("a",{href:"#",className:"link-btn",children:"📚 คู่มือการใช้งาน"}),t.jsx("a",{href:"#",className:"link-btn",children:"🐛 รายงานปัญหา"}),t.jsx("a",{href:"#",className:"link-btn",children:"💝 สนับสนุนโครงการ"})]})]})]})]})]})};setTimeout(()=>{const o=document.createElement("link");o.rel="stylesheet",o.href="/src/styles/themes.css",document.head.appendChild(o);const e=document.createElement("link");e.rel="stylesheet",e.href="/src/App.css",document.head.appendChild(e)},50);const Be=()=>{const[o,e]=h.useState("boot"),[s,n]=h.useState(null),[i,r]=h.useState([]),[l,a]=h.useState(null),[c,d]=h.useState(!1),{user:g,loginAsGuest:f}=Pe(),{t:v}=Me();h.useEffect(()=>{o==="boot"&&!c&&(async()=>{try{n(new Te(je)),setTimeout(()=>_.trackPageView("app_start"),100),setTimeout(()=>{g||f()},200),d(!0)}catch(k){console.error("App initialization error:",k),d(!0)}})()},[o,c,g,f]),h.useEffect(()=>{const x=localStorage.getItem("saku-dojo-progress");if(x)try{r(JSON.parse(x))}catch(k){console.error("Failed to load progress:",k)}},[]);const u=x=>{const k=[...i,x];r(k),localStorage.setItem("saku-dojo-progress",JSON.stringify(k))},y=x=>{if(!s)return;let k=!1;x.mode==="Quiz"?k=s.startQuizSession(x.track,x.framework,x.level,x.questionCount):x.mode==="Study"?k=s.startStudySession(x.track,x.framework,x.level):k=s.startSession(x),k?e("quiz"):alert("ไม่พบคำถามสำหรับการตั้งค่านี้ กรุณาเลือกใหม่")},b=()=>{if(!s)return;const x=s.finishSession();x&&(x.progressEntry&&(a(x.progressEntry),u(x.progressEntry)),e("result"))},p=()=>{s&&(s.resetSession(),a(null),e("start"))},j=()=>{e("progress")},N=()=>{e("settings")},T=()=>{e("start"),_.track("splash_completed",{duration:Date.now()-window.__appStartTime||0})},E=()=>{console.warn("Boot sequence failed, falling back to start screen"),e("start"),_.track("boot_error",{timestamp:Date.now()})};if(h.useEffect(()=>{if(o==="boot"){window.__appStartTime=Date.now();const x=setTimeout(()=>{o==="boot"&&(console.warn("Boot stage timeout, forcing transition to start"),E())},15e3);return()=>clearTimeout(x)}},[o]),o==="boot"||!s)try{return t.jsx(We,{onComplete:T})}catch(x){return console.error("Splash component error:",x),E(),null}return t.jsxs("div",{className:"app",id:"main-content",children:[t.jsx("header",{className:"app-header",children:t.jsx("div",{className:"container",children:t.jsxs("div",{className:"header-content",children:[t.jsxs("div",{className:"header-main",children:[t.jsx("h1",{className:"app-title",children:"🎌 SAKULANG"}),t.jsx("p",{className:"app-subtitle",children:v("tagline")})]}),t.jsxs("div",{className:"header-actions",children:[g&&t.jsx("div",{className:"user-info",children:t.jsxs("span",{className:"user-name",children:["👋 ",g.username]})}),t.jsx("button",{onClick:N,className:"btn btn-secondary btn-sm settings-btn",title:v("settings"),children:"⚙️"})]})]})})}),t.jsx("main",{className:"app-main",children:t.jsxs("div",{className:"container",children:[o==="start"&&t.jsx(Le,{onStartSession:y,onShowProgress:j,progressCount:i.length}),o==="quiz"&&t.jsx(Je,{engine:s,onFinish:b,onExit:p}),o==="result"&&l&&t.jsx(ze,{progress:l,onRestart:p,onShowProgress:j}),o==="progress"&&t.jsx(Oe,{progressHistory:i,onBack:p,onClearHistory:()=>{r([]),localStorage.removeItem("saku-dojo-progress")}}),o==="settings"&&t.jsx(Ue,{onBack:p})]})}),t.jsx("footer",{className:"app-footer",children:t.jsx("div",{className:"container",children:t.jsx("p",{children:"© 2024 SAKULANG - Free Language Learning Platform"})})})]})};function Fe(){return t.jsx(qe,{children:t.jsx(Be,{})})}"serviceWorker"in navigator&&setTimeout(()=>{navigator.serviceWorker.register("/sw.js").then(()=>{_.track("service_worker_registered")}).catch(()=>{})},2e3);setTimeout(()=>{_.track("app_initialized",{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform})},100);D.createRoot(document.getElementById("root")).render(t.jsx(K.StrictMode,{children:t.jsx(Fe,{})}));
